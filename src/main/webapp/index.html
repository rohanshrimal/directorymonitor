<!doctype html>
<html lang="en" style="height: 100%">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="icon" href="favicon-folder-open.ico">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">	
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<script src="https://code.highcharts.com/stock/highstock.js"></script>
<script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/drilldown.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

<script src="https://cdn.jsdelivr.net/npm/gijgo@1.9.10/js/gijgo.min.js" type="text/javascript"></script>
<link href="https://cdn.jsdelivr.net/npm/gijgo@1.9.10/css/gijgo.min.css" rel="stylesheet" type="text/css" />

<script src= "https://cdn.zingchart.com/zingchart.min.js"></script>

<style type="text/css">
.table-hover tbody tr:hover td, .table-hover tbody tr:hover th {
	background-color: #dee2e6;
}

.ui-front {
	z-index: 1200;
}

.ui-widget {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
		"Helvetica Neue", Arial, sans-serif, "Apple Color Emoji",
		"Segoe UI Emoji", "Segoe UI Symbol";
	font-size: 1.1em;
}

.ui-menu-item li:hover {
	background-color: #e8f0fe;
}

.ui-state-focus {
	border-color : #dee2e6 !important;
	background-color: #dee2e6 !important;
	font-weight: 500 !important;
	background-image: none !important;
}

.ui-corner-all{
	white-space: nowrap; 
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
}

.ui-menu {
	max-height: 300px;
	margin-bottom: 10px;
	overflow-y: auto;
	-webkit-overflow-scrolling: touch;
}

.dropdown-item:active {
	color: #fff;
	text-decoration: none;
	background-color: #343a40;
	border-color: #343a40;
}

.dropdown-item:hover {
	color: #fff;
	text-decoration: none;
	background-color: #343a40;
	border-color: #343a40;
}

.currentSelected {
	background-color: #e8f0fe;
	font-weight: 500;
}

.multiSelected {
    background-color: #e8f0fe !important;
	font-weight: 500;
}

.currentSelectedAlphabet {
	font-weight: 700;
	text-decoration: underline !important;
}

.currentMidSelected {
	background-color: #e8f0fe !important;
	font-weight: 500;
}

#metaTab link, .nav-tabs .nav-link.active {
	font-weight: bold;
	color: #007bff;
	border-color: white;
}

#tokenTab link, .nav-tabs .nav-link.active {
	font-weight: bold;
	color: #007bff;
	border-color: white;
}

.highcharts-credits {
	display: none;
}

#wordCloudModalBody-license-text {
	display: none;
}

textarea {
	border: none;
	outline: none;
	white-space: pre;
	overflow-y: hidden;
	-webkit-box-shadow: none;
	-moz-box-shadow: none;
	box-shadow: none;
}

a, a:active, a:focus {
	outline: none;
}

.no-outline{
	outline: none !important;
	outline-width: 0px !important;
	outline-style: none !important;
	box-shadow: none !important;
}

.form-control:focus {
    color: #495057;
    background-color: #fff;
    border-color: #ced4da;
    outline: 0;
    box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
}

.btn:focus {
	outline: none !important;
	outline-width: 0px;
	outline-style: none;
	box-shadow: none;
}

.no-action:hover {
	color: black;
	text-decoration: none;
	background-color: white;
	border-color: white;
}

.btn-dark.focus, .btn-dark:focus {
	box-shadow: 0 0 0 0rem rgba(0, 0, 0, 0) !important;
}

.btn-outline-secondary.focus, .btn-outline-secondary:focus {
	box-shadow: 0 0 0 0rem rgba(0, 0, 0, 0) !important;
	border-top: none !important;
	border-left: none !important;
	border-right: none !important;
	border-radius: 0rem !important;
}

.mylink{
	color: #6c757d;
	border-color: #dee2e6; 
	border-left: none;
	border-right: none; 
	border-top: none; 
	border-radius: 0rem;
	border-width: thin;
}

.mylink:focus, .mylink:hover {
	color: #495057;
	border-color: #495057;
}

.myoption:focus, .myoption:hover {
	background-color: #dee2e6;
	color: #495057;
}

.myoption {
	color: #6c757d;
}

dark.dropdown-toggle:focus {
	box-shadow: 0 0 0 0rem rgba(0, 0, 0, 0) !important;
}

no-shadow:focus {
	box-shadow: 0 0 0 0rem rgba(0, 0, 0, 0) !important ;
}

.mydatepicker {
	max-width: 80%; 
	border-top: none;
	border-radius: 0rem; 
	border-left: none; 
	border-right: none;
	margin-top: 0%;
	padding-top: 0%;
}

.mydatepicker:focus, .mydatepicker:hover {
	color: #495057;
	border-color: #495057;
}

.gj-datepicker-bootstrap [role=right-icon] button {
    border: 0px solid #ced4da;
}

::-webkit-scrollbar {
    width: 6px;
}

/* Track */
::-webkit-scrollbar-track {
    -webkit-box-shadow: inset 0 0 6px rgba(255,255,255,1); 
    -webkit-border-radius: 0px;
    background-color: rgba(255,255,255,1);
    border-radius: 0px;
}

/* Handle */
::-webkit-scrollbar-thumb {
    -webkit-border-radius: 0px;
    border-radius: 0px;
    background: rgba(222,226,230,1); 
    -webkit-box-shadow: inset 0 0 0px rgba(0,0,0,0.5); 
}

::-webkit-scrollbar-thumb:window-inactive {
    background: rgba(222,226,230,0.4); 
}

#tokenStatisticsTableBody{
	overflow-y : auto; 
	overflow-x : hidden !important;
}

.create {
	background-color: #d4edda;
	color: #155724; 
}

.delete{
	background-color: #f8d7da;
	color: #721c24; 
}

.menu {
  width: 200px;
  z-index: 1;
  box-shadow: 0 4px 5px 3px rgba(0, 0, 0, 0.2);
  position: fixed;
  display: none;
  transition: 0.2s display ease-in;
  background-color: white;
}

.menu-options {
    list-style: none;
    padding: 10px 0;
    z-index: 1;
}

.menu-option {
      font-weight: 500;
      z-index: 1;
      font-size: 14px;
      padding: 10px 40px 10px 20px;
      cursor: pointer;
}

.menu-option:hover {
     background: #dee2e6;
}

.containerCheck {
    display: block;
    position: relative;
    padding-left: 27px;
    margin-bottom: 5px;
    cursor: pointer;
    font-size: 1rem;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

/* Hide the browser's default checkbox */
.containerCheck input {
    position: absolute;
    opacity: 0;
    cursor: pointer;
}

/* Create a custom checkbox */
.checkmark {
    position: absolute;
    top: 5px;
    left: 0;
    height: 15px;
    width: 15px;
    background-color: #eee;
}

/* On mouse-over, add a grey background color */
.containerCheck:hover input ~ .checkmark {
    background-color: #ccc;
}

/* When the checkbox is checked, add a blue background */
.containerCheck input:checked ~ .checkmark {
    background-color: #2196F3;
}

/* Create the checkmark/indicator (hidden when not checked) */
.checkmark:after {
    content: "";
    position: absolute;
    display: none;
}

/* Show the checkmark when checked */
.containerCheck input:checked ~ .checkmark:after {
    display: block;
}

/* Style the checkmark/indicator */
.containerCheck .checkmark:after {
    left: 5px;
    top: 3px;
    width: 5px;
    height: 10px;
    border: solid white;
    border-width: 0 3px 3px 0;
    -webkit-transform: rotate(45deg);
    -ms-transform: rotate(45deg);
    transform: rotate(45deg);
}

</style>

<title>Monitor Your Directories Here</title>
</head>
<body style="min-height: calc(100%);">
	<nav class="navbar navbar-expand-lg navbar-light bg-white border mb-0">
		<button class="navbar-toggler" type="button" data-toggle="collapse"
			data-target="#navbarTogglerDemo03"
			aria-controls="navbarTogglerDemo03" aria-expanded="false"
			aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<ul class="nav flex-column mt-0 mb-0">
 			<li><a class="navbar-brand my-0 py-0 font-weight-bold" href="#"> <i class="fa fa-folder-open" aria-hidden="true"></i> DIRECTORY MONITOR</a></li>
			<li><small class="text-muted font-italic my-0 py-0 align-top">Monitor your directories from anywhere.</small></li>
		</ul>
		
		<div class="collapse navbar-collapse pl-5" id="navbarTogglerDemo03">
			<div class="input-group w-50 mx-5" id="searchInputGroup">
			  <input type="text" class="form-control no-outline" placeholder="Search files by keywords..." aria-label="Text input with segmented dropdown button" id="searchBox">
			  <div class="input-group-append stopSplitClose" id="searchInputGroup">
			    <button type="button" class="btn btn-dark" type="submit" onclick="searchContent();">Search</button>
			    <button type="button" class="btn btn-dark dropdown-toggle dropdown-toggle-split no-shadow" aria-haspopup="false" aria-expanded="false" id="searchSplitter" onclick="showSearchModal();">
			      <span class="sr-only">Toggle Dropdown</span>
			    </button>
			    <div class="dropdown-menu w-100" id="searchDropDown">
			      <div class="dropdown-item no-action"> 
			      	 <table class="table table-borderless">
			      	 	<tr class="table table-borderless d-flex mb-0">
			      	 		<td class="col-3 mt-2 mb-0 pb-0 border-0">Search By</td>
			      	 		<td class="col-8 border-0">
						      	<div class="dropdown show d-inline">
								  <a class="btn dropdown-toggle w-80 mb-0 mylink" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" onclick="showMenu();">Select Attribute
								  </a>
								
								  <div class="dropdown-menu w-100" aria-labelledby="dropdownMenuLink" id="attributeMenu">
								    <a class="dropdown-item myoption w-100" href="#" onclick="setAttributeToSearch('name','Name of file');">Name of File</a>
								    <a class="dropdown-item myoption w-100" href="#" onclick="setAttributeToSearch('dateModified','Date Modified');">Modified date</a>
								    <a class="dropdown-item myoption w-100" href="#" onclick="setAttributeToSearch('creationDate','Creation Date');">Creation Date</a>
								    <a class="dropdown-item myoption w-100" href="#" onclick="setAttributeToSearch('extension','Extension of file');">Extension of file</a>
								  </div>
								</div>
						    </td>
							<td class="col-1 border-0">
								<button type="button" class="close no-outline" aria-label="Close" onclick="showSearchModal();">
				          			<span aria-hidden="true" class="text-secondary no-outline">&times;</span>
				        		</button>
			        		</td>
	        			</tr>
	        			
	        			<tr class="table table-borderless d-flex">
			      	 		<td class="col-3 mt-2 mb-0 pb-0 border-0">Location</td>
			      	 		<td class="col-8 border-0">
						      	<div class="dropdown show d-inline">
								  <a class="btn dropdown-toggle mb-0 mylink" href="#" role="button" id="dropdownLocationLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" onclick="showAvailableLocation();" title="All Monitored Directories">All Monitored Directories
								  </a>
								
								  <div class="dropdown-menu" aria-labelledby="dropdownLocationLink" id="locationMenu">
								   
								  </div>
								</div>
						    </td>
							<td class="col-1 border-0">
			        		</td>
	        			</tr>
	        			
					  	<tr class="table table-borderless mb-0 d-none" id="name">
	        				<td class="col-3 border-0">File Name</td>
	        				<td class="col-9 border-0"><input class="mylink w-100 no-outline" id="searchbyname" placeholder=" Enter a term that matches part of file name" type="text"/></td>
							<td class="border-0"></td>
						</tr>
						
						<tr class="table table-borderless mb-0 d-none" id="dateModified">
	        				<td class="col-3 border-0">Modified on</td>
	        				<td class="col-7 border-0"><input class="mydatepicker" readonly id="searchbydateModified" placeholder=" Select modified date" style="background-color: white; display: inline;"/></td>
							<td class="col-2 border-0"></td>
						</tr>
						
						<tr class="table table-borderless mb-0 d-none" id="creationDate" >
	        				<td class="col-3 border-0">Created at</td>
	        				<td class="col-7 border-0"><input class="mydatepicker" readonly id="searchbycreationDate" placeholder=" Select creation date" style="background-color: white; display: inline;"/></td>
							<td class="border-0"></td>
						</tr>
						
						<tr class="table table-borderless mb-0 d-none" id="extension" >
	        				<td class="col-3 border-0">Extension</td>
	        				<td class="col-7 border-0"><input class="mylink w-100 no-outline" id="searchbyextension" placeholder=" Enter extension" type="text"/></td>
							<td class="col-2 border-0"></td>
						</tr>
						
						<tr class="table table-borderless mb-0 d-none" id="searchButton" >
	        				<td class="col-2 border-0"></td>
	        				<td class="col-8 border-0"></td>
							<td class="col-2 border-0"><button class="btn btn-dark" onclick="searchFiles()">Search</button></td>
						</tr>
					</table>
			      </div>
			    </div>
			  </div>
			</div>
			
			<ul class="navbar-nav mr-auto mt-2 mt-lg-0">
				<li class="nav-item active"><a class="nav-link" href="#"></a></li>
				<li class="nav-item"><a class="nav-link" href="#"></a></li>
				<li class="nav-item"><a class="nav-link" href="#"></a></li>
			</ul>
			
			<div class="btn-group mr-0 pr-0">
			  <button type="button" class="btn btn-dark dropdown-toggle mr-5" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			     <i class="fa fa-plus-circle" aria-hidden="true"></i> Add
			  </button>
			  
			  <div class="dropdown-menu">
			    <button class="dropdown-item d-inline align-middle mx-0 px-3" type="button" data-toggle="modal" data-target="#addNewDirectoryModal" onclick="getRootDirectories();"><i class="material-icons d-inline align-middle">create_new_folder</i>&nbsp;Directory To Monitor</button>
			    <button class="dropdown-item d-inline align-middle mx-0 px-3" type="button" data-toggle="modal" data-target="#addNewIndexStorageModal"><i class="material-icons d-inline align-middle">storage</i>&nbsp;Index Storage Directory</button>
			    <button class="dropdown-item d-inline align-middle mx-0 px-3" type="button" data-toggle="modal" data-target="#addStopWordModal"><i class="material-icons d-inline align-middle">stop</i>&nbsp;Stop Word</button>
			  </div>
			</div>
			
			<div class="btn-group mr-5">
			  <button type="button" class="btn btn-dark dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" onclick="">
			     <i class="far fa-eye" aria-hidden="true"></i> View
			  </button>
			  
			  <div class="dropdown-menu">
			    <button class="dropdown-item d-inline align-middle mx-0 px-2" type="button" onclick="getTokenStatistics('a');"> <i class="fas fa-chart-pie pr-1" aria-hidden="true"></i> Tokens</button>
			    <button class="dropdown-item d-inline align-middle mx-0 px-1" type="button" onclick="getStopWords();" data-toggle="modal" data-target="#showStopWordsModal"><i class="material-icons d-inline align-middle pl-0 pr-1 ml-0">stop</i>Stop Words</button>
			    <button class="dropdown-item d-inline align-middle mx-0 px-1" type="button" data-toggle="modal" data-target="#showRecentActivityModal" onclick="renderRecentActivity();"><i class="material-icons d-inline align-middle pl-0 pr-1 ml-0">notifications</i>Recent Activity</button>
			  </div>
			</div>
		</div>
	</nav>
	
	<div class="container-fluid">
		<div class="row bg-light pt-3" id="mainRow" style="height: calc(100vh - 72px)">
			<div class="col-md-2 bg-light" id="firstCol">
				<div class="font-weight-normal px-2 py-2 text-center bg-dark text-white rounded">Monitored Directories</div>
				
				<table class="table table-fixed" style="table-layout: fixed;">
					<tbody id="directoryTable" style="display:block; overflow: auto; height: 74vh">
					</tbody>
				</table>
				<div id="progressToggler" class="float-left fixed-bottom d-none mb-5 align-items-center" style="z-index: 1000; position: absolute; margin-right: 80%; margin-left:5%; opacity: 1; background-color:white; height:15vh;">
					
					<div id="progressWrapper" class="d-none col-11" style="height:13vh; overflow-y: auto; overflow-x: hidden ">
							
					</div>
					<div class="fas fa-chevron-circle-down fa-rotate-270 fa-2x col" onclick="toggleProgress()" style="width: 13vh;" id="expandIcon"></div>
				</div>
			</div>
			
			<div class="col-md-10 bg-light" id="midCol">
				<div class="font-weight-normal pl-2 pr-1 py-2 bg-dark text-white rounded d-flex">
				
				<span id="directoryTreeHead" class="col-9">Explorer</span> 
			
				<span class="d-none col-9" id="tokenSelector">
		    	<button type="button" onclick="getTokenStatistics('a');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">A</button>
		    	<button type="button" onclick="getTokenStatistics('b');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">B</button>
		    	<button type="button" onclick="getTokenStatistics('c');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">C</button>
		    	<button type="button" onclick="getTokenStatistics('d');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">D</button>
		    	<button type="button" onclick="getTokenStatistics('e');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">E</button>
		    	<button type="button" onclick="getTokenStatistics('f');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">F</button>
		    	<button type="button" onclick="getTokenStatistics('g');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">G</button>
		    	<button type="button" onclick="getTokenStatistics('h');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">H</button>
		    	<button type="button" onclick="getTokenStatistics('i');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">I</button>
		    	<button type="button" onclick="getTokenStatistics('j');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">J</button>
		    	<button type="button" onclick="getTokenStatistics('k');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">K</button>
		    	<button type="button" onclick="getTokenStatistics('l');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">L</button>
		    	<button type="button" onclick="getTokenStatistics('m');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">M</button>
		    	<button type="button" onclick="getTokenStatistics('n');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">N</button>
		    	<button type="button" onclick="getTokenStatistics('o');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">O</button>
		    	<button type="button" onclick="getTokenStatistics('p');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">P</button>
		    	<button type="button" onclick="getTokenStatistics('q');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">Q</button>
		    	<button type="button" onclick="getTokenStatistics('r');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">R</button>
		    	<button type="button" onclick="getTokenStatistics('s');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">S</button>
		    	<button type="button" onclick="getTokenStatistics('t');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">T</button>
		    	<button type="button" onclick="getTokenStatistics('u');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">U</button>
		    	<button type="button" onclick="getTokenStatistics('v');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">V</button>
		    	<button type="button" onclick="getTokenStatistics('w');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">W</button>
		    	<button type="button" onclick="getTokenStatistics('x');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">X</button>
		    	<button type="button" onclick="getTokenStatistics('y');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">Y</button>
		    	<button type="button" onclick="getTokenStatistics('z');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">Z</button>
		    	<button type="button" onclick="getTokenStatistics('#');" class="btn btn-secondary inline py-0 my-0 mx-0 px-2 alpha">#</button>
			  	</span>	
			  	
			  	<span class="d-inline col float-right">
				
				<button type="button" id="showDetails" class="btn btn-dark inline text-white inline mx-0 my-0 pt-1 pb-1 float-right "><i class="fa fa-info float-right" aria-hidden="true" data-toggle="tooltip" data-placement="top" id="showDetailIcon" title="View Details"></i></button>
				
				<span class="dropdown">
				<button type="button" id="showSearch" data-toggle="dropdown" aria-haspopup="false" aria-expanded="false" class="btn btn-dark inline text-white inline mx-2 px-2 my-0 pt-1 pb-1 float-right "><i class="fas fa-search float-right" aria-hidden="true" data-toggle="tooltip" data-placement="top" id="showSearchIcon" title="Search Table" onclick="cleanSearchTableBox();"></i></button>  
				  <span class="dropdown-menu border-0 mr-3" aria-labelledby="showSearch" style="background-color: transparent; min-width: 15vw">
				   	<span class="input-group mb-3">
					  <input type="text" class="form-control no-outline border-right-0" placeholder="Search Table" aria-label="Search table" aria-describedby="basic-addon2" id="tableSearchBox" oninput="searchTable();">
					  <span class="input-group-append">
					    <button class="btn" type="button" style="background-color: white !important; border: 1px solid #ced4da; border-left: none;"><i class="fas fa-search" style="color: #ced4da"></i></button>
					  </span>
					</span>
				  </span>
				</span>
				
				<span class="dropdown showFilter">
				<button type="button" id="showFilter" data-toggle="dropdown" aria-haspopup="false" aria-expanded="true" class="btn btn-dark inline text-white inline mx-2 px-2 my-0 pt-1 pb-1 float-right"><i class="fas fa-filter float-right" aria-hidden="true" data-toggle="tooltip" data-placement="top" id="showFilterIcon" title="Attributes to show"></i></button>  
				  <span id="showFilterId" class="dropdown-menu pl-3 pt-3 pb-3 pr-2 mr-3" aria-labelledby="showFilter" style="min-width: 11vw">
				   	
	
					<label class="containerCheck form-check-label">Size
					  <input class="attributes form-check-input" type="checkbox" id="size" onchange="addAttributesToPublish();">
					  <span class="checkmark disabled"></span>
					</label>
					<label class="containerCheck form-check-label">Extension
					  <input class="attributes form-check-input" type="checkbox" id="extension" onchange="addAttributesToPublish();">
					  <span class="checkmark disabled"></span>
					</label>
					<label class="containerCheck form-check-label">Created
					  <input class="attributes form-check-input" type="checkbox" id="creationDate" onchange="addAttributesToPublish();">
					  <span class="checkmark disabled"></span>
					</label>
					<label class="containerCheck form-check-label">Last Modified
					  <input class="attributes form-check-input" type="checkbox" id="lastModified" onchange="addAttributesToPublish();">
					  <span class="checkmark disabled"></span>
					</label>
					<label class="containerCheck form-check-label">Last Opened
					  <input class="attributes form-check-input" type="checkbox" id="lastOpened" onchange="addAttributesToPublish();">
					  <span class="checkmark disabled"></span>
					</label>
						
				  </span>
				</span>
		
				</span>
				</div>
				
				<div class="container-fluid px-0" id="directoryContainer">
					<table class="table" id="filesAndSubDirectoryTable" style="table-layout: fixed;">
						<thead id="filesAndSubDirectoryTableHead" class="mb-0 border-0" style="display: block;"></thead>
						<tbody id="filesAndSubDirectoryTableBody" class="mb-0 border-0" style="display: block; overflow: auto; height: 67vh"></tbody>
					</table>
				</div>
				
				<div class="container-fluid bg-white px-0 d-none" id="tokenContainer">	
					<table class="table" id="tokenStatisticsTable" style="table-layout: fixed;">
						<thead id="tokenStatisticsTableHead" class="mb-0 border-0" style="display: block;"></thead>
						<tbody id="tokenStatisticsTableBody" class="mb-0 border-0 mx-0 px-0" style="display: block; height:66vh"></tbody>
					</table>
				</div>
				
				<div class="container-fluid px-0 d-none" id="folderSummaryContainer">	
					<div class="d-flex">
						<div class="col bg-white">
							<table class="table" style="table-layout: fixed; margin-bottom: 0rem!important;">
								<thead><tr><td class="border-0" style="font-size: 18px; font-weight: 400">Folder Statistics of <span id="summarizedFolder" style="font-weight: 500"></span></td></tr></thead>
								<tbody>
									<tr class="d-flex border-0">
										<td class="col text-truncate border-0" style="color: #007bff" rowspan="2"><i class="fa fa-files-o fa-2x mr-3" aria-hidden="true"></i><span style="font-size: 4vh" id="totalNumberOfFiles" data-toggle="tooltip"></span></td>
										<td class="col text-truncate border-0" style="color: #007bff" rowspan="2"><i class="fa fa-hdd-o fa-2x mr-3" aria-hidden="true"></i><span style="font-size: 4vh" id="totalSizeOfFolder" data-toggle="tooltip"></span></td>
										<td class="col text-truncate border-0" style="color: #007bff" rowspan="2"><i class="fa fa-folder fa-2x mr-3" aria-hidden="true"></i><span style="font-size: 4vh" id="totalNumberOfFolders" data-toggle="tooltip"></span></td>
										<td class="col text-truncate border-0" style="color: #007bff" rowspan="2"><i class="fa fa-bar-chart fa-2x mr-3" aria-hidden="true"></i><span style="font-size: 4vh" id="totalNumberOfTokens" data-toggle="tooltip">100000 Tokens</span></td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="d-flex mt-2">
						<div id="filesByExtensionContainer" class="col-6 bg-white">
						</div>
						<div id="folderTokensContainer" class="col-6 bg-white" style="border-left : .5rem solid #f8f9fa; ">
						</div>
					</div>
				</div>
			</div>
			
			<div class="col-md-3 bg-light" id="lastCol" style="display: none">
				 <div class="font-weight-normal px-2 py-2 text-center bg-dark text-white rounded"><span id="detailsOfFile">Details</span> <a href="#" id="hideDetails" class="text-white"><i class="fa fa-times float-right fa-lg mt-1" aria-hidden="true" data-toggle="tooltip" data-placement="top" id="hideDetailsIcon" title="Hide Details"></i></a></div>
 				<div id="metaTokenDetail">
				 	<ul class="nav nav-tabs nav-justified">
					  <li class="nav-item">
					    <a class="nav-link active" data-toggle="tab" href="#meta" id="metaTab">META</a>
					  </li>
					  <li class="nav-item">
					    <a class="nav-link" data-toggle="tab" href="#token" id="tokenTab">TOKENS</a>
					  </li>
					</ul>
					
					 <div class="tab-content bg-white">
					    <div id="meta" class="container tab-pane active px-0">
					     <div class="text-dark h3 text-center mb-0 pb-3 pt-2 bg-white text-truncate" id="nameDetail"></div>
					     <div class="text-dark h3 text-center mb-0 pb-3 bg-white"><i class="fa fa-folder fa-3x" aria-hidden="true" id="typeIconDetail"></i></div>
					      <table class="table table-fixed">
							    <tbody class="mr-0" style="height: 47vh; overflow: auto; display: block; width: 100%">
							    <tr class="table mr-0 d-flex mb-0">
							      <td class="col">Type</td>
							      <td id="typeDetail" class="mr-0 col"></td>
							    </tr>
							    <tr class="table mr-0 d-flex mb-0">
							      <td class="col">Size</td>
							      <td id="sizeDetail" class="mr-0 col"></td>
							    </tr>
							     <tr class="table mr-0 d-flex mb-0">
							      <td class="col">Extension</td>
							      <td id="extensionDetail" class="mr-0 col"></td>
							    </tr>
							    <tr class="table mr-0 d-flex mb-0">
							      <td class="col">Modified</td>
							      <td id="modifiedDetail" class="mr-0 col"></td>
							    </tr>
							    <tr class="table mr-0 d-flex mb-0">
							      <td class="col">Opened</td>
							      <td id="openedDetail" class="mr-0 col"></td>
							    </tr>
							    <tr class="table mr-0 d-flex mb-0">
							      <td class="col">Created</td>
							      <td id="createdDetail" class="mr-0 col"></td>
							    </tr>
							    <tr class="table mr-0 d-flex mb-0" id="downloadDetails">
							      <td class="col">Download</td>
							      <td class="mr-0 col"><a id="downloadFileLink" class="pb-0 mb-1 pt-0 mt-0 ml-3"><i class="fa fa-download" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Click to Download"></i></a></td>
							    </tr>
							    <tr class="table mr-0 d-flex mb-0" id="uploadDetails">
							      <td class="col">Upload</td>
							      <td class="mr-0 col">
								      <form method="POST" action="uploadFile" enctype="multipart/form-data">
										<input type="file" name="file" style="display: none;" id="fileUploadField">
										<input type="text" name ="path" style="display: none" id="uploadFileDirectoryPath"> 
										<a href="#" class="pb-0 mb-1 pt-0 mt-0 ml-3" onclick="document.getElementById('fileUploadField').click(); return false;"><i class="fa fa-upload" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Click to Upload"></i></a>
									  </form>	    
							      </td>
							    </tr>
							    </tbody>
						</table>
					    </div>
					    <div id="token" class="container tab-pane fade mb-0">
						   
						    <table class="table table-hover mb-1" id="fileTokenTable" style="table-layout: fixed;">
								<thead id="fileTokenTableHead" class="mb-0 border-0" style="display: block;"></thead>
								<tbody id="fileTokenTableBody" class="mb-0 border-0" style="display: block; overflow: auto; height: 55vh"></tbody>
							</table>
							
							 <div class="text-center d-none" id="wordCloudLink"><a href="#" onclick="renderWordCloud();" class="text-center" style="max-width: 100%" data-toggle="modal" data-target="#wordCloudModal">Click here to visualize token</a></div>		
					    </div>
					 </div>
				 </div>
				 <div id="tokenFileDetails" class="d-none bg-white">
					<br><br>
					<div class="text-center">Select token to get details.</div>
					<br><br> 
				 </div>
			</div>
		</div>
	</div>
	
	<div class="modal fade" id="addNewDirectoryModal" tabindex="-1" role="dialog" aria-labelledby="addNewDirectoryLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
	  <div class="modal-dialog modal-lg" role="document" style="max-width: 70%">
	    <div class="modal-content">
	      <div class="modal-header bg-dark">
	        <h5 class="modal-title text-white h5">Add New Directory to Monitor</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="clearAddNewDirectoryModal();" id="addNewDirectoryCloseBtn">
	          <span aria-hidden="true" class="text-white">&times;</span>
	        </button>
	      </div>
	       <form onsubmit="event.preventDefault(); addPath();">
	      	<div class="modal-body">
	      		<table class="table table-sm" id="browseDirectoryTable" style="table-layout: fixed;">
						<tbody id="browseDirectoryTableBody" class="mb-0 border" style="display: block; overflow: auto; height: 50vh"></tbody>
				</table>
			  <div class="form-group">
			    <label for="directoryPath">Directory Path</label>
			    <input type="text" size="500" class="form-control no-outline" id="pathInput" placeholder="Enter directory path here..">
			  </div>
			</div>
			
			
	      <div class="modal-footer">
	        <button type="submit" class="btn btn-dark">Add</button>
	      </div>
	      </form>
	    </div>
	  </div>
	</div>

	<div class="modal fade" id="addNewIndexStorageModal" tabindex="-1" role="dialog" aria-labelledby="addNewIndexStorageLabel" aria-hidden="true">
	  <div class="modal-dialog modal-lg" role="document">
	    <div class="modal-content">
	      <div class="modal-header bg-dark">
	        <h5 class="modal-title text-white h5">Add New Index Storage Directory</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="clearAddNewIndexStorageModal();">
	          <span aria-hidden ="true" class="text-white">&times;</span>
	        </button>
	      </div>
	       <form onsubmit="event.preventDefault(); setIndexDirectory();">
		    <div class="modal-body">
				  <div class="form-group">
				    <label for="directoryPath">Storage Directory Path</label>
				    <input type="text" size="500" class="form-control" id="storagePathInput" placeholder="Enter storage directory path here..">
				  </div>
				  	<div class="alert alert-danger my-0" role="alert" id="addNewStorageDirectoryFailureAlert" style="display: none;"></div>
					<div class="alert alert-success my-0" role="alert" id="addNewStorageDirectorySuccessAlert" style="display: none;"></div>
			</div>
				
		    <div class="modal-footer">
		        <button type="submit" class="btn btn-dark">Add</button>
		    </div>
	      </form>
	    </div>
	  </div>
	</div>
	
	<div class="modal fade" id="fileContentModal" tabindex="-1" role="dialog" aria-labelledby="fileContentLabel" aria-hidden="true">
	  <div class="modal-dialog modal-lg" role="document" style="max-width: 70%">
	    <div class="modal-content">
	      <div class="modal-header bg-dark">
	        <h5 class="modal-title text-white h5">File Content</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden ="true" class="text-white">&times;</span>
	        </button>
	      </div>
		    <div class="modal-body" id="fileContentModalBody">
				<textarea id="contentTextArea" readonly style="max-width:100%; max-height:100% ;min-width: 100%; min-height:100%;"></textarea>
			</div>	
		    <div class="modal-footer">
		    </div>
	    </div>
	  </div>
	</div>
	
	<div class="modal fade" id="filesOfTokenModal" tabindex="-1" role="dialog" aria-labelledby="fileOfTokenLabel" aria-hidden="true">
	  <div class="modal-dialog modal-lg" role="document" style="max-width: 80%">
	    <div class="modal-content">
	      <div class="modal-header bg-dark">
	        <h5 class="modal-title text-white h5">Files List</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="clearFilesOfTokenModal();">
	          <span aria-hidden ="true" class="text-white">&times;</span>
	        </button>
	      </div>
		    <div class="modal-body" id="filesOfTokenModalBody">
		    	<div class="container-fluid bg-white px-0" id="filesofTokenContainer">
					<table class="table" id="filesOfTokenTable" style="table-layout: fixed;">
						<thead id="filesOfTokenTableHead" class="mb-0 border-0" style="display: block;"></thead>
					    <tbody id="filesOfTokenTableBody" class="mb-0 border-0" style="display: block; overflow: auto; height: 70vh"></tbody>
					</table>
				</div>
			</div>	
		    <div class="modal-footer">
		    </div>
	    </div>
	  </div>
	</div>
	
	<div class="modal pb-5" id="wordCloudModal" tabindex="-1" role="dialog" aria-labelledby="wordCloudLabel" aria-hidden="true">
	  <div class="modal-dialog modal-lg pb-5 mb-5" role="document" style="max-width: 70%">
	    <div class="modal-content">
	      <div class="modal-header bg-dark">
	        <h5 class="modal-title text-white h5">Token Visualization</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden ="true" class="text-white">&times;</span>
	        </button>
	      </div>
	      
		    <div class="modal-body px-0 py-0" style="width: 100%; height: 85vh;">
		    	<ul class="nav nav-tabs nav-justified bg-light">
				  <li class="nav-item">
				    <a class="nav-link active" data-toggle="tab" href="#pieTabPan" id="pieTab">Pie Chart</a>
				  </li>
				  <li class="nav-item">
				    <a class="nav-link" data-toggle="tab" href="#wordCloudTabPan" id="wordCloudTab">Word Cloud</a>
				  </li>
				</ul>
				
				<div class="tab-content bg-white" style="width: 100%; height: 90%; min-height: 90%;">
				   <div id="wordCloudTabPan" class="container tab-pane" style="width: 100%; height: 100%; min-height: 100%;">
						<div id="wordCloudModalBody" style="width: 100%; height: 100%;" oncontextmenu="hideMenu();"></div>
				   </div>
				   <div id="pieTabPan" class="container tab-pane pt-5 active" style="width: 100%; height: 80%; min-height: 100%;">
				      	<div id="tokenCanvas" style="width: 100%; height: 100%; min-height: 90%;"></div>		
				   </div>
				</div>
			</div>	
	    </div>
	  </div>
	</div>
	
	<div class="modal fade" id="showRecentActivityModal" tabindex="-1" role="dialog" aria-labelledby="showRecentActivityLabel" aria-hidden="true">
	  <div class="modal-dialog modal-lg" role="document" style="max-width: 80%">
	    <div class="modal-content">
	      <div class="modal-header bg-dark">
	        <h5 class="modal-title text-white h5 text-center">Recent Activity</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden ="true" class="text-white">&times;</span>
	        </button>
	      </div>
		    <div class="modal-body" id="showRecentActivityModalBody">
		    	<div class="container-fluid bg-white px-0" id="recentActivityContainer">
					<table class="table" id="recentActivityTable" style="table-layout: fixed;">
						<thead id="recentActivityTableHead">
						<tr><td class="border-0">No activity found</td></tr>
						</thead>
						<tbody id="recentActivityTableBody" style="display: block; overflow: auto; height: 65vh"></tbody>
					</table>
				</div>
			</div>	
	    </div>
	  </div>
	</div>
	
	<div class="modal fade" id="addStopWordModal" tabindex="-1" role="dialog" aria-labelledby="addStopWordLabel" aria-hidden="true">
	  <div class="modal-dialog modal-lg" role="document">
	    <div class="modal-content">
	      <div class="modal-header bg-dark">
	        <h5 class="modal-title text-white h5">Add Stop Words</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="clearStopWordsModal()">
	          <span aria-hidden ="true" class="text-white">&times;</span>
	        </button>
	      </div>
	       <form onsubmit="event.preventDefault(); addStopWords();">
		    <div class="modal-body">
				  <div class="form-group">
				    <label for="directoryPath">Enter stop words</label>
				    <textarea class="form-control no-outline" rows="10" id="stopWordInput" placeholder="Enter comma seperated word list here..."></textarea>
				  </div>
				  	<div class="alert alert-danger my-0" role="alert" id="addStopWordFailureAlert" style="display: none;"></div>
					<div class="alert alert-success my-0" role="alert" id="addStopWordSuccessAlert" style="display: none;"></div>
			</div>
				
		    <div class="modal-footer">
		        <button type="submit" class="btn btn-dark">Add</button>
		    </div>
	      </form>
	    </div>
	  </div>
	</div>
	
	<div class="modal fade" id="showStopWordsModal" tabindex="-1" role="dialog" aria-labelledby="showStopWordsLabel" aria-hidden="true">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header bg-dark">
	        <h5 class="modal-title text-white h5 text-center">Stop words list</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden ="true" class="text-white">&times;</span>
	        </button>
	      </div>
		    <div class="modal-body" id="showStopWordModalBody">
		    	<div class="container-fluid bg-white px-0" id="stopWordContainer">
					<table class="table" id="stopWordTable" style="table-layout: fixed;">
						<thead id="stopWordTableHead" style="display: block;">
						<tr class="table d-flex mb-0">
							<th class="col-4 border-0">#</th>
							<th class="col-8 border-0">Stop Word</th>
						</tr>
						</thead>
						<tbody id="stopWordTableBody" style="display: block; overflow: auto; height: 65vh"></tbody>
					</table>
				</div>
			</div>	
	    </div>
	  </div>
	</div>
	
	<div class="menu">
	  <ul class="menu-options" id="contextMenuOptions" style="margin-bottom: 0px;">
	    <li class="menu-option perma" onclick="document.getElementById('showDetails').click();" id="contextMenuHideShow">View Details</li>
	  </ul>
	</div>
	
	<span class="alert alert-success fixed-bottom text-center mb-2" role="alert" id="addNewDirectorySuccessAlert" style="display: none;"></span>
	<span class="alert alert-danger fixed-bottom text-center mb-2" role="alert" id="addNewDirectoryFailureAlert" style="display: none;"></span>
	
				
	<script type="text/javascript">
	
	var websocket=new WebSocket("ws://localhost:8080/directorymonitor/ServerEndPoint");
	var attributesToPublish;
	var directoryMap;
	var searchDirectoryMap;
	var filesAndSubDirectoriesMap;
	var expFilesAndSubDirectoriesList = [];
	var tokenStatistics;
	var fileOrDirectory;
	var currentParent;
	var currentParentName;
	var globalParent;
	var tokenData;
	var currentSort;
	var sortedName = false;
	var sortedSize = false;
	var sortedLastModified = false;
	var sortedCreationDate = false;
	var sortedLastOpened = false;
	var sortedExtension = false;
	var recentActivities = [];
	var list = null;
	var filesOfTokenList = null;
	var fileTokenList = null;
	var filesAndSubDirectoryList = null;
	var indexProgresses={};
	
	var head = {
				"name" : "<th class=\"col border-0\" id=\"NameHead\">Name<a href=\"#\" onclick=\"sortByName();\"><i id=\"sortNameIcon\" class=\"fas fa-sort px-3 text-dark\"></i></a></th>" ,
				"size" : "<th class=\"col border-0\" id=\"SizeHead\">Size<a href=\"#\" onclick=\"sortBySize();\"><i id=\"sortSizeIcon\" class=\"fas fa-sort px-3 text-dark\"></i></a></th>" ,
			    "lastModified" : "<th class=\"col border-0 pl-2\" id=\"LastModifiedHead\">Modified<a href=\"#\" onclick=\"sortByLastModified();\"><i id=\"sortLastModifiedIcon\" class=\"fas fa-sort px-3 text-dark\"></i></a></th>" ,
				"creationDate" : "<th class=\"col border-0 pl-2\" id=\"CreationDateHead\">Created<a href=\"#\" onclick=\"sortByCreationDate();\"><i id=\"sortCreationDateIcon\" class=\"fas fa-sort px-3 text-dark\"></i></a></th>" ,
				"lastOpened" : "<th class=\"col border-0 pl-2\" id=\"LastOpenedHead\">Opened<a href=\"#\" onclick=\"sortByLastOpened();\"><i id=\"sortLastOpenedIcon\" class=\"fas fa-sort px-3 text-dark\"></i></a></th>" ,
				"extension" : "<th class=\"col border-0 pl-0\" id=\"ExtensionHead\">Extension<a href=\"#\" onclick=\"sortByExtension();\"><i id=\"sortExtensionIcon\" class=\"fas fa-sort px-3 text-dark\"></i></a></th>"
	};
	
	function getRootDirectories(){
		var request = getXmlHttpRequestObject();
		request.onreadystatechange = renderRootDirectories;
		request.open("get", "rootDirectories", true);
		request.send();
	}
	
	function renderRootDirectories(){
		 if(this.readyState===4 && this.status===200){
			 var rootDirectories = JSON.parse(this.responseText);
			 $("#browseDirectoryTableBody").children().remove();
			 var table=document.getElementById("browseDirectoryTableBody");
			 var row, cell, i=0;
				
			 for(i=0; i<rootDirectories.length; i++) {
				row = table.insertRow(i);
				row.id = "browser-"+rootDirectories[i];
				row.rowIndex = i;
				row.className = "table mb-0 d-flex border-0";
				
				cell = row.insertCell(0);
				cell.className = "border-0 text-truncate col-12";
				cell.innerHTML = "<a href=\"#\" id='"+"browse-"+rootDirectories[i]+"' onclick=\"browseSubDirectories('"+encodeURI(rootDirectories[i])+"',20)\" class=\"mr-2\"><i class=\"fas fa-angle-right\"></i></a> <a href='#' title='"+rootDirectories[i]+"' onclick=\"setPathInput('"+encodeURI(rootDirectories[i])+"');\">"+ "<i class=\"fa fa-folder\" aria-hidden=\"true\"></i>\t" +rootDirectories[i]+"</a>";
			 }
		 }
	}
	
	function browseSubDirectories(path, currentPadding) {
		path = decodeURI(path);
	
		if(document.getElementById("browse-"+path).firstChild.classList.contains("fa-angle-right")) {
			document.getElementById("browse-"+path).firstChild.classList.remove("fa-angle-right");
			document.getElementById("browse-"+path).firstChild.classList.add("fa-angle-down");
			
			var request = getXmlHttpRequestObject();
			var expFilesAndSubDirectory = [];
			var expFilesAndSubDirectoriesMap = null;
			
			request.onreadystatechange = function() {
		        if (this.readyState == 4 && this.status == 200) {
		        	expFilesAndSubDirectoriesMap = JSON.parse(this.responseText);
		       		renderBrowseSubDirectories(expFilesAndSubDirectoriesMap, path, currentPadding);
		       }
		    };
			request.open("post", "browseFilesAndSubDirectory", true);
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			var data = "path="+encodeURI(path);
			request.send(data);	
		}
		else{
			document.getElementById("browse-"+path).firstChild.classList.remove("fa-angle-down");
			document.getElementById("browse-"+path).firstChild.classList.add("fa-angle-right");
			
			path = encodeURI("browser-"+path);
			hideBrowseSubDirectories(path);
		}
	}
	
	function renderBrowseSubDirectories(filesAndSubDirectoriesMap, path, currentPadding) {
		if(filesAndSubDirectoriesMap == null){
			return;
		}
		var filesAndSubDirectories = Object.keys(filesAndSubDirectoriesMap);
		var table=document.getElementById("browseDirectoryTableBody");
	
		var row = document.getElementById("browser-"+path);
		var index = row.rowIndex;
		var cell0, cell1, cell2;
		var i=0;
		
		for(i=0; i < filesAndSubDirectories.length; i++,index++ ) {
			row = table.insertRow(index+1);
			row.id = "browser-"+filesAndSubDirectories[i];
			row.className = "browser-"+path +" "+"table mb-0 d-flex border-0";
					
			cell = row.insertCell(0);
			cell.className = "border-0 text-truncate";
			var newPadding = currentPadding+20;		
			cell.innerHTML = "<a style='padding-left :"+currentPadding+"px"+"' href=\"#\" id='"+"browse-"+filesAndSubDirectories[i]+"' onclick=\"browseSubDirectories('"+encodeURI(filesAndSubDirectories[i])+"',"+newPadding+")\" class=\"mr-2\"><i class=\"fas fa-angle-right\"></i></a> <a href='#' title='"+filesAndSubDirectories[i]+"' onclick=\"setPathInput('"+encodeURI(filesAndSubDirectories[i])+"');\">"+ "<i class=\"fa fa-folder\" aria-hidden=\"true\"></i>\t" +filesAndSubDirectoriesMap[filesAndSubDirectories[i]]+"</a>";
		}
	}
	
	function hideBrowseSubDirectories(path){
		var table=document.getElementById("browseDirectoryTableBody");
		path = decodeURI(path);
		var classElements = document.getElementsByClassName(path);
		var index = -1;
		var filesAndSubDirectories = [];
		
		for(var i=0; i<classElements.length; i++){
			filesAndSubDirectories.push(classElements[i].getAttribute("id"));
		}

		for(var i=0; i<filesAndSubDirectories.length; i++){
			hideBrowseSubDirectories(encodeURI(filesAndSubDirectories[i]));
			index = document.getElementById(filesAndSubDirectories[i]).rowIndex;
			table.deleteRow(index);
		}
	}

	function setPathInput(path){
		path = decodeURI(path);
		document.getElementById("pathInput").value = path;
	}
	
	$(document).on('click', '.showFilter', function (e) {
		e.stopPropagation();
	});
	
	function viewFileByMenu() {
		var prevMidSelected = document.getElementsByClassName('currentMidSelected');
    	for (var i = 0; i < prevMidSelected.length; i++) {
    		prevMidSelected[i].firstChild.firstChild.click();
    		break;
    	}	
	}
	
	function exploreDirectory(){
		var prevSelected = document.getElementsByClassName('currentSelected');
	    var flag = false;
		for (var i = 0; i < prevSelected.length; i++) {
	    	prevSelected[i].firstChild.childNodes[1].click();
	    	flag = true;
	    	break;
	    }
	    
		if(flag == false){
	    	var prevMidSelected = document.getElementsByClassName('currentMidSelected');
	    	for (var i = 0; i < prevMidSelected.length; i++) {
	    		prevMidSelected[i].firstChild.firstChild.click();
	    		break;
	    	}
		}
	}
	
	function getFolderSummary(){
		var prevSelected = document.getElementsByClassName('currentSelected');
	    var path = null;
		var flag = false;
	    for (var i = 0; i < prevSelected.length; i++) {
	    	path = prevSelected[i].firstChild.childNodes[1].getAttribute("title");
	    	flag = true;
	    	break;
	    }
		
	    if(flag == false) {
			var prevMidSelected = document.getElementsByClassName('currentMidSelected');
			for (var i = 0; i < prevMidSelected.length; i++) {
	    		path = prevMidSelected[i].firstChild.firstChild.getAttribute("title");
	    		break;
	    	}
	    }
		
		getCountOfFiles(path);
		getCountOfFolders(path);
		getFolderSize(path);
		getFilesByExtension(path);
		getFolderTokens(path);
		
		document.getElementById("directoryContainer").classList.add("d-none");
		document.getElementById("tokenContainer").classList.add("d-none");
		document.getElementById("folderSummaryContainer").classList.remove("d-none");
		document.getElementById("summarizedFolder").innerHTML = path;
	}
	
	function getCountOfFiles(path){
		var request = getXmlHttpRequestObject();
		request.onreadystatechange = renderCountOfFiles;
		request.open("post", "fileCount", true);
		request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
		var data = "path="+encodeURI(path);
		request.send(data);
	}
	
	function renderCountOfFiles(){
		 if(this.readyState===4 && this.status===200){
			 document.getElementById("totalNumberOfFiles").innerHTML = JSON.parse(this.responseText)+" Files";
			 document.getElementById("totalNumberOfFiles").setAttribute("data-original-title", "Total number of files: "+JSON.parse(this.responseText)+" Files");
		 }
	}
	
	function getCountOfFolders(path){
		var request = getXmlHttpRequestObject();
		request.onreadystatechange = renderCountOfFolders;
		request.open("post", "folderCount", true);
		request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
		var data = "path="+encodeURI(path);
		request.send(data);
	}
	
	function renderCountOfFolders(){
		 if(this.readyState===4 && this.status===200){
			 document.getElementById("totalNumberOfFolders").innerHTML = JSON.parse(this.responseText)+" Folders";
			 document.getElementById("totalNumberOfFolders").setAttribute("data-original-title", "Total number of folders: "+JSON.parse(this.responseText)+" Folders");
		 }
	}
	
	function getFolderSize(path){
		var request = getXmlHttpRequestObject();
		request.onreadystatechange = renderFolderSize;
		request.open("post", "folderSize", true);
		request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
		var data = "path="+encodeURI(path);
		request.send(data);
	}
	
	function renderFolderSize(){
		 if(this.readyState===4 && this.status===200){
			 document.getElementById("totalSizeOfFolder").innerHTML = convertFromBytes(JSON.parse(this.responseText));
			 document.getElementById("totalSizeOfFolder").setAttribute("data-original-title", "Folder size on disk: "+convertFromBytes(JSON.parse(this.responseText)));
		 }
	}
	
	function getFilesByExtension(path){
		var request = getXmlHttpRequestObject();
		request.onreadystatechange = renderFilesByExtension;
		request.open("post", "filesByExtension", true);
		request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
		var data = "path="+encodeURI(path);
		request.send(data);
	}
	
	function renderFilesByExtension(){
		 if(this.readyState===4 && this.status===200){
			 var filesByExtension = JSON.parse(this.responseText);
			 var barChartJsonArray = [];
			 var drilldownArray = [];
			 var dataArray = [];
			 var subDataArray = [];
			 var drillJSON = {};
			 var json = {};
			 var point = {};
			 var i=0;
			 var maxNumberForY;
			 
			 for(var ext in filesByExtension){
				 json = {};
				 if(ext.trim().length == 0){
					 continue;
				 }
				 
				 if(i==0){
					 maxNumberForY = filesByExtension[ext].length + 5;
					 i++;
				 }
				 
				 json["name"] = ext;
				 json["y"] = filesByExtension[ext].length;
				 json["drilldown"] = ext;
				 barChartJsonArray.push(json);
				 
				 dataArray = [];
				 for(var file in filesByExtension[ext]){
					 subDataArray = [];
					 subDataArray.push(filesByExtension[ext][file].name);
					 subDataArray.push(filesByExtension[ext][file].size);

					 dataArray.push(subDataArray);
				 }
				 
				 drillJSON = {};
				 drillJSON["name"] = ext;
				 drillJSON["id"] = ext;
				 drillJSON["data"] = dataArray;
				 
				 point = {};
				 point["pointFormat"] = '<b>{point.y} Bytes</b>';
				 drillJSON["tooltip"] = point;
				 
				 drilldownArray.push(drillJSON);
				 
			 }
			
			 var maxLength;
			 if(drilldownArray.length > barChartJsonArray.length){
				 maxLength = drilldownArray.length;
			 }
			 else{
				 maxLength = barChartJsonArray.length;
			 }
				 
				Highcharts.chart('filesByExtensionContainer', {
				  chart: {
				    type: 'pie'
				  },
				  title: {
				    text: 'Extensions'
				  },
				  subtitle: {
				    text: ''
				  },
				  plotOptions: {
					pie:{
						turboThreshold : maxLength
					},
				    series: {
				      dataLabels: {
			            	enabled: false,
			            },
				    }
				  },
				
				  tooltip: {
				    pointFormat: '<b>{point.y} files ({point.percentage:.1f}%)</b>'
				  },
				 
				  "series": [
				    {
				      "name": 'Extension',
				      "colorByPoint": true,
				      "data": barChartJsonArray,
				    }
				  ],
				  "drilldown": {
					  "drillUpButton": {
				            "relativeTo": 'spacingBox',
				            "position": {
				                "y": 25,
				                "x": 0
				            },
					  },
					  "series": drilldownArray
				  }
				});
		}
	}
	
	function getFolderTokens(path){
		var request = getXmlHttpRequestObject();
		request.onreadystatechange = renderFolderTokens;
		request.open("post", "folderTokens", true);
		request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
		var data = "path="+encodeURI(path);
		request.send(data);
	}
	
	function renderFolderTokens(){
		 if(this.readyState===4 && this.status===200){
			 var folderTokens = JSON.parse(this.responseText);
			 var jsonArray = [];
			 var i=0;			 
			 for(var token in folderTokens){
				 if(i > 100){
					 break;
				 }
				 json = {};
				 if(token.trim().length == 0){
					 continue;
				 }
				  
				 json["name"] = token;
				 json["y"] = folderTokens[token];
				 
				 jsonArray.push(json);
				 i++;
			}
			 
			 document.getElementById("totalNumberOfTokens").innerHTML = Object.keys(folderTokens).length + " Tokens";
			 document.getElementById("totalNumberOfTokens").setAttribute("data-original-title", "Total number of tokens: "+Object.keys(folderTokens).length);
			 
			 var maxLength = jsonArray.length;
			 
				Highcharts.chart('folderTokensContainer', {
				  chart: {
				    type: 'pie'
				  },
				  title: {
				    text: 'Tokens'
				  },
				  subtitle: {
				    text: ''
				  },
				  plotOptions: {
					pie:{
						turboThreshold : maxLength
					},
				    series: {
				      dataLabels: {
			            	enabled: false,
			            },
				    }
				  },
				
				  tooltip: {
				    pointFormat: '<b>{point.y} : ({point.percentage:.1f}%)</b>'
				  },
				 
				  "series": [
				    {
				      "name": 'Extension',
				      "colorByPoint": true,
				      "data": jsonArray,
				    }
				  ],
				});

		 }
	}
	
	function toggleProgress() {
		if(document.getElementById("progressToggler").classList.contains("miniProgress")){
			document.getElementById("progressToggler").classList.remove("miniProgress");
			document.getElementById("progressToggler").style.marginRight = "80%";
			document.getElementById("progressWrapper").classList.add("d-none");
			document.getElementById("expandIcon").classList.remove("fa-chevron-circle-up");
			document.getElementById("expandIcon").classList.add("fa-chevron-circle-down");
		}
		else{
			document.getElementById("progressToggler").classList.add("miniProgress");
			document.getElementById("progressToggler").style.marginRight = "-150%";
			document.getElementById("progressWrapper").classList.remove("d-none");
			document.getElementById("expandIcon").classList.remove("fa-chevron-circle-down");
			document.getElementById("expandIcon").classList.add("fa-chevron-circle-up");
		}	
	}
	
	function maximizeProgress(){
		document.getElementById("progressToggler").classList.remove("d-none");
		document.getElementById("progressToggler").classList.add("d-flex");
		document.getElementById("progressToggler").classList.add("miniProgress");
		document.getElementById("progressToggler").style.marginRight = "-150%";
		document.getElementById("progressWrapper").classList.remove("d-none");
		document.getElementById("expandIcon").classList.remove("fa-chevron-circle-down");
		document.getElementById("expandIcon").classList.add("fa-chevron-circle-up");
	}

	function cleanSearchTableBox() {
		document.getElementById("tableSearchBox").value = '';
	}
		
	function addAttributesToPublish(){
		attributesToPublish = [];
		attributesToPublish.push("name");
		var attributes = document.getElementsByClassName("attributes");
		var i = 0;
		for(i=0; i < attributes.length ;i++){
			if(attributes[i].checked == true){
				attributesToPublish.push(attributes[i].id);		
			}
		}
		
		if(!document.getElementById("directoryContainer").classList.contains("d-none")) {
			var filesAndSubDirectories = [];
			for(var files in filesAndSubDirectoriesMap){
				filesAndSubDirectories.push(filesAndSubDirectoriesMap[files]);
			}
			
			renderFilesAndSubDirectories(filesAndSubDirectories, currentParent, currentParentName, globalParent);
		}
	}
	
	function searchTable(){
		var searchQuery = document.getElementById("tableSearchBox").value.trim();
		var searchResults = {};
		var filesAndSubDirectories = [];
		
		if(!$("#directoryContainer").hasClass("d-none")){
			
			for(var files in filesAndSubDirectoriesMap){
				if(filesAndSubDirectoriesMap[files].name.toLowerCase().includes(searchQuery.toLowerCase())){
					filesAndSubDirectories.push(filesAndSubDirectoriesMap[files]);
				}
			}
			renderFilesAndSubDirectories(filesAndSubDirectories, currentParent, currentParentName, globalParent);
		}	
		else if(!$("#tokenContainer").hasClass("d-none")){
	
			for(var token in tokenStatistics){
				if(token.includes(searchQuery.toLowerCase())){
					searchResults[token] =  tokenStatistics[token];
				}
			}
			if(Object.keys(searchResults).length > 0)
			renderTokenStatistics(searchResults);	
		}
	}
	
	function addStopWords(){
		var request = getXmlHttpRequestObject();
		request.onreadystatechange = addStopWordsResponse;
		request.open("post", "stopwords", true);
		request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
					
		document.getElementById("addStopWordSuccessAlert").style.display = "none";
    	document.getElementById("addStopWordFailureAlert").style.display = "none";
    	
		var data = "words="+document.getElementById("stopWordInput").value;
		request.send(data);
	}
	
	function addStopWordsResponse(){
		 if(this.readyState===4 && this.status===200){
		        var response = JSON.parse(this.responseText);
		    	var alertBox = null;
		    	
		    	document.getElementById("addStopWordSuccessAlert").style.display = "none";
		    	document.getElementById("addStopWordFailureAlert").style.display = "none";
		    	
		    	if(response.flag == true){
		    		alertBox = document.getElementById("addStopWordSuccessAlert");
		    		alertBox.style.display = "block";
		    		alertBox.innerHTML = response.msg;
		    	}
		    	else{
		    		alertBox = document.getElementById("addStopWordFailureAlert");
		    		alertBox.style.display = "block";
		    		alertBox.innerHTML = response.msg;
		    	}
		 }
	}
	
	function clearStopWordsModal(){
		document.getElementById("stopWordInput").value = "";
		document.getElementById("addStopWordSuccessAlert").style.display = "none";
   		document.getElementById("addStopWordFailureAlert").style.display = "none";
	}
	
	function getStopWords(){
		var request = getXmlHttpRequestObject();
		request.onreadystatechange = renderStopWords;
		request.open("get", "stopwords", true);
		request.send();
	}
	
	function renderStopWords(){
		 if(this.readyState===4 && this.status===200){
			 $("#stopWordTableBody").children().remove();   
			 
			 var response = JSON.parse(this.responseText);   
		     var tbody = document.getElementById("stopWordTableBody");
		     var row;
		     var cell0, cell1;
		     
		     if(response == null || response.length == 0){
		    	 row = tbody.insertRow(0);
		    	 row.innerHTML = "No Stop Words Found.";
		    	 return;
		     }
		     
		     for(i=0 ; i < response.length ; i++){
	        	row = tbody.insertRow(i);
	        	row.classList.add("table","d-flex","mb-0");
	        	
	        	cell0 = row.insertCell(0);
	        	cell0.innerHTML = i+1;
	        	cell0.classList.add("col-4");
	        	
	        	cell1 = row.insertCell(1);
	        	cell1.innerHTML = response[i];
	        	cell1.classList.add("col-8","text-truncate");
	         }
		 }		
	}
	
	function setIndexingProgress(jsonData) {
		var currentIndexDirectory = jsonData.type.substr(jsonData.type.indexOf("INDEX_PROGRESS")+14);
		
		if(indexProgresses[jsonData.type.substr(jsonData.type.indexOf("INDEX_PROGRESS")+14)] == null){
			indexProgresses[jsonData.type.substr(jsonData.type.indexOf("INDEX_PROGRESS")+14)] = true;
			var progressWrapper = document.getElementById("progressWrapper");
			var newProgressBar = "<div class=\"row\">"+
								 "<div class=\"col-9 text-truncate\"><small id=\"indexingPath"+currentIndexDirectory+"\"></small></div><div class=\"col-3\"><small class=\"float-right mr-1\" id=\"indexingNumber"+currentIndexDirectory+"\"></small></div>"+
								 "</div>"+
			                     "<div class=\"progress d-none\" id=\"progressBarParent"+currentIndexDirectory+"\">"+
			                     "<div id=\"indexingProgressBar"+currentIndexDirectory+"\" class=\"progress-bar bg-success\" role=\"progressbar\" aria-valuenow=\"75\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 0%\"></div>"+
			                     "</div><br>";
			                     
			progressWrapper.innerHTML = newProgressBar + progressWrapper.innerHTML;
		}
		
		var msg = jsonData.message;
		var processedPercent = parseFloat(msg.substring(0,msg.indexOf("-")));
		var restMsg = msg.substring(msg.indexOf("-")+1);
		var indexingNumber = restMsg.substring(0, restMsg.indexOf("$"));
		var indexingPath = restMsg.substring(restMsg.indexOf("$")+1);
		var progressBar = document.getElementById("indexingProgressBar"+currentIndexDirectory);
		
		document.getElementById("progressBarParent"+currentIndexDirectory).classList.remove("d-none");
		progressBar.style.width = Math.ceil(processedPercent)+"%";
		progressBar.innerHTML = processedPercent + "%";
		
		document.getElementById("indexingNumber"+currentIndexDirectory).innerHTML = indexingNumber;
		document.getElementById("indexingPath"+currentIndexDirectory).innerHTML = indexingPath;
		document.getElementById("indexingPath"+currentIndexDirectory).setAttribute("title",indexingPath);
	}
	
	  $("#fileUploadField").change(function(e){
            var formData = new FormData();
            formData.append('file', this.files[0]);
        
            $.ajax({
                url : 'uploadFile?path='+encodeURI($('#uploadFileDirectoryPath').val()),
                data : formData,
                enctype: 'multipart/form-data',
                processData : false,
                contentType : false,
                type : 'POST',
                success : function(data) {
                    alert(data);
                },
                error : function(err) {
                    alert("ERROR");
                }
            });
		});

	    $('#searchbydateModified').datepicker({
	        uiLibrary: 'bootstrap4'
	    });
		
	    $('#searchbycreationDate').datepicker({
	        uiLibrary: 'bootstrap4'
	    });

		$(".stopSplitClose").click(function(e) {
			document.getElementById("attributeMenu").classList.remove("d-block");
			document.getElementById("attributeMenu").classList.add("d-none");
		});
		
		$(".gj-picker").click(function(e) {
		    e.stopPropagation(); 
		    return false;        
		});
		
		function showSearchModal(){
			document.getElementById("searchDropDown").classList.toggle("show");
			document.getElementById("searchInputGroup").classList.toggle("show");
		}
		
		function setAttributeToSearch(id, attribute){
			document.getElementById("dropdownMenuLink").innerHTML = attribute;
			document.getElementById("attributeMenu").classList.remove("d-block");
			document.getElementById("attributeMenu").classList.add("d-none");
			
			var selectedAttribute = document.getElementsByClassName('searchAttribute');
		    
			for (var i = 0; i < selectedAttribute.length; i++) {
		    	selectedAttribute[i].classList.remove("d-flex");
		    	selectedAttribute[i].classList.add("d-none");
		    	selectedAttribute[i].classList.remove("searchAttribute");
		    }
		    
			document.getElementById(id).classList.remove("d-none");
			document.getElementById(id).classList.add("d-flex");
			document.getElementById(id).classList.add("searchAttribute");
			
			document.getElementById("searchButton").classList.remove("d-none");
			document.getElementById("searchButton").classList.add("d-flex");
		}
		
		function showMenu() {
			document.getElementById("attributeMenu").classList.remove("d-none");
			document.getElementById("attributeMenu").classList.add("d-block");
		}
		
		function showAvailableLocation(){
			var locationMenu = document.getElementById("locationMenu");
			var availableLocations = "<a class=\"dropdown-item myoption w-100 text-truncate\" title=\"All Monitored Directories\" href=\"#\" onclick=\"selectSearchLocation(this.title)\">All Monitored Directories</a>";
			$("#locationMenu").children().remove();
			
			for(var monitoredDirectory in searchDirectoryMap){
				availableLocations = availableLocations + "<a class=\"dropdown-item myoption w-100\" title=\""+directoryMap[monitoredDirectory].path+"\" href=\"#\" onclick=\"selectSearchLocation(this.title)\">"+directoryMap[monitoredDirectory].name+"</a>"; 
			}
			
			locationMenu.innerHTML = availableLocations; 
		}

		function selectSearchLocation(path){
			if(path == "All Monitored Directories"){
				document.getElementById("dropdownLocationLink").innerHTML = "All Monitored Directories";
				document.getElementById("dropdownLocationLink").setAttribute("title", "All Monitored Directories");
			}
			else {
				document.getElementById("dropdownLocationLink").innerHTML = directoryMap[path].name;
				document.getElementById("dropdownLocationLink").setAttribute("title",path);
			}
		}

		function searchFiles(){
			var selectedAttribute = document.getElementsByClassName('searchAttribute');
			var searchLocation = document.getElementById("dropdownLocationLink").title;
		    var attribute = null;
		    
			for (var i = 0; i < selectedAttribute.length; i++) {
		    	attribute = selectedAttribute[i].id;
		    }
			var searchQuery = document.getElementById("searchby"+attribute).value;
			var request = getXmlHttpRequestObject();
			request.onreadystatechange = searchResults;
			request.open("get", "files/"+attribute+"?searchQuery="+encodeURI(searchQuery)+"&searchLocation="+encodeURI(searchLocation), true);
			request.send();
		}
		
		function searchResults() {
		    if(this.readyState===4 && this.status===200){
				var searchResult = JSON.parse(this.responseText);
				if( searchResult != null && jQuery.isEmptyObject(searchResult) == false){
					filesAndSubDirectoriesMap = JSON.parse(request.responseText);
			        currentParent = null;
			        currentParentName = null;
			        var filesAndSubDirectories = [];
			        
			        for(var key in filesAndSubDirectoriesMap){
						filesAndSubDirectories.push(filesAndSubDirectoriesMap[key]);
					}
			       	renderFilesAndSubDirectories(filesAndSubDirectories, null, null, "noParent");
			    }
				else{
					alert("No Results Found...!!!");
				}
		    }
		}
		
		$(function () {
		  $('[data-toggle="tooltip"]').tooltip({trigger : 'hover'});
		});
			
		$("#hideDetailsIcon").click(function(){
		    if($("#lastCol").is(':visible'))
		      {
				$("#lastCol").animate({ width: 'hide' });
				document.getElementById("lastCol").classList.add("d-none");
				document.getElementById("midCol").classList.remove('col-md-7');
				document.getElementById("midCol").classList.add('col-md-10');
				document.getElementById("showDetailIcon").removeAttribute("data-original-title");
				document.getElementById("showDetailIcon").setAttribute("data-original-title", "View Details");
				document.getElementById("contextMenuHideShow").innerHTML = "View Details";
		      }
		      else
		      {
		        $("#lastCol").animate({ width: 'show' }); 
		        document.getElementById("lastCol").classList.remove("d-none");
		        document.getElementById("midCol").classList.remove('col-md-10');
				document.getElementById("midCol").classList.add('col-md-7');
				document.getElementById("showDetailIcon").removeAttribute("data-original-title");
				document.getElementById("showDetailIcon").setAttribute("data-original-title", "Hide Details");
				document.getElementById("contextMenuHideShow").innerHTML = "Hide Details";
		      }
		    
		    if(!document.getElementById("folderSummaryContainer").classList.contains("d-none")){
		    	getFolderSummary();
		    }
		    
		    $('[data-toggle="tooltip"]').tooltip({
			    trigger : 'hover'
			}); 
		});
		
		$("#showDetails").click(function(){
		    if($("#lastCol").is(':visible'))
		      {
				$("#lastCol").animate({ width: 'hide' });
				document.getElementById("lastCol").classList.add("d-none");
				document.getElementById("midCol").classList.remove('col-md-7');
				document.getElementById("midCol").classList.add('col-md-10');
				document.getElementById("showDetailIcon").removeAttribute("data-original-title");
				document.getElementById("showDetailIcon").setAttribute("data-original-title", "View Details");
				document.getElementById("contextMenuHideShow").innerHTML = "View Details";
		      }
		      else
		      {
		        $("#lastCol").animate({ width: 'show' }); 
		        document.getElementById("lastCol").classList.remove("d-none");
		        document.getElementById("midCol").classList.remove('col-md-10');
				document.getElementById("midCol").classList.add('col-md-7');
				document.getElementById("showDetailIcon").removeAttribute("data-original-title");
				document.getElementById("showDetailIcon").setAttribute("data-original-title", "Hide Details");
				document.getElementById("contextMenuHideShow").innerHTML = "Hide Details";
		      }	
		    
		    if(!document.getElementById("folderSummaryContainer").classList.contains("d-none")){
		    	getFolderSummary();
		    }
		    
		    $('[data-toggle="tooltip"]').tooltip({
			    trigger : 'hover'
			}); 
		});
		
		window.onload = function() {
			attributesToPublish = [];
			attributesToPublish.push("name");
			attributesToPublish.push("size");
			attributesToPublish.push("lastModified");
			
			document.getElementById("size").checked = true;
			document.getElementById("lastModified").checked = true;
			
			getDirectoryList();
		}
		
		$(document).scroll(function() {
		       if($(window).scrollTop() > 50){
			        $(".ui-front").css("z-index","0");
		       }else if($(window).scrollTop() < 50){
			        $(".ui-front").css("z-index","1200");
		       }
		});
		
	  
		websocket.onmessage = 
			function processMessage(message) {
				var jsonData=JSON.parse(message.data);
			    if(jQuery.isEmptyObject(jsonData)===false && jsonData.message!=null) {
			    	if(jsonData.type.startsWith("INDEX_PROGRESS")){
						setIndexingProgress(jsonData);
					}
			    	else if(jsonData.type == "FILE_CREATE"){
			    		recentActivities.splice(0, 0, jsonData);
			    		renderRecentActivity();
			    	}
			    	else if(jsonData.type == "FILE_DELETE"){
			    		recentActivities.splice(0, 0, jsonData);
			    		renderRecentActivity();
			    	}
			    	else if(jsonData.type == "DIRECTORY_CREATE"){
			    		recentActivities.splice(0, 0, jsonData);
			    		renderRecentActivity();
			    	}
			    	else if(jsonData.type == "DIRECTORY_DELETE"){
			    		recentActivities.splice(0, 0, jsonData);
			    		renderRecentActivity();
			    	}
			    }
		}
		
		function renderRecentActivity(){
			var table = document.getElementById("recentActivityTableBody");
			$("#recentActivityTableBody").children().remove();
			
			if(recentActivities.length > 0)
			$("#recentActivityTableHead").children().remove();
			
			var i=0;
			for(i=0 ;i < recentActivities.length; i++){
				var row = table.insertRow(i);
				row.className = "table d-flex mb-0 border-0";
				
				var cell0 = row.insertCell(0);
				var cell1 = row.insertCell(1);
				var cell2 = row.insertCell(2);
				
				if(recentActivities[i].type == "FILE_CREATE"){
		    		cell0.innerHTML = "<i class=\"far fa-plus-square fa-lg pr-2 pl-2\"></i>";
		    		cell0.className = "col-1 text-truncate create border-0";
		    		
		    		cell1.innerHTML = recentActivities[i].message;
		    		cell1.className = "col-8 text-truncate create border-0";
		    		
		    		cell2.innerHTML = time_ago(new Date(recentActivities[i].timestamp));
		    		cell2.className = "col-3 text-truncate create border-0";
		    	}
		    	else if(recentActivities[i].type == "FILE_DELETE"){
		    		cell0.innerHTML = "<i class=\"far fa-minus-square fa-lg pr-2 pl-2\"></i>";
		    		cell0.className = "col-1 text-truncate delete border-0";
		    		
		    		cell1.innerHTML = recentActivities[i].message;
		    		cell1.className = "col-8 text-truncate delete border-0";
		    		
		    		cell2.innerHTML = time_ago(new Date(recentActivities[i].timestamp));
		    		cell2.className = "col-3 text-truncate delete border-0";
		    	}
		    	else if(recentActivities[i].type == "DIRECTORY_CREATE"){
		    		cell0.innerHTML = "<i class=\"fas fa-folder-plus fa-2x pr-2\"></i>";
		    		cell0.className = "col-1 text-truncate py-2 create border-0";
		    		
		    		cell1.innerHTML = recentActivities[i].message;
		    		cell1.className = "col-8 text-truncate create border-0";
		    		
		    		cell2.innerHTML = time_ago(new Date(recentActivities[i].timestamp));
		    		cell2.className = "col-3 text-truncate create border-0";
		    	}
		    	else if(recentActivities[i].type == "DIRECTORY_DELETE"){
		    		cell0.innerHTML = "<i class=\"fas fa-folder-minus fa-2x pr-2\"></i>";
		    		cell0.className = "col-1 text-truncate py-2 delete border-0";
		    		
		    		cell1.innerHTML = recentActivities[i].message;
		    		cell1.className = "col-8 text-truncate delete border-0";
		    		
		    		cell2.innerHTML = time_ago(new Date(recentActivities[i].timestamp));
		    		cell2.className = "col-3 text-truncate delete border-0";
		    	}
			}
			
		}
		
		function getXmlHttpRequestObject() {
			var xmlHttpReq;
			if (window.XMLHttpRequest) {
				request = new window.XMLHttpRequest();
			} else if (window.ActiveXObject) {
				request = new window.ActiveXObject();
			} else {
				request = null;
			}
			return request;
		}

		function addPath() {
			var request = getXmlHttpRequestObject();
			request.onreadystatechange = addPathResponse;
			request.open("post", "path", true);
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
						
			document.getElementById("addNewDirectorySuccessAlert").style.display = "none";
	    	document.getElementById("addNewDirectoryFailureAlert").style.display = "none";
	    	
			var data = "path="+encodeURI(document.getElementById("pathInput").value);
			request.send(data);
			
			$("#addNewDirectoryCloseBtn").click();
			maximizeProgress();
		}
		
		function addPathResponse() {
		    if(this.readyState===4 && this.status===200){
		    	var response = JSON.parse(this.responseText);
		    	var alertBox = null;
		 
		    	if(response != null){
		    		if(jQuery.isEmptyObject(response)===true){
			    		alertBox = document.getElementById("addNewDirectoryFailureAlert");
			    		alertBox.style.display = "block";
			    		alertBox.innerHTML = "Directory indexing failed.";
			    		setTimeout(function(){ alertBox.style.display = "none"; }, 1000);
		    		}
		    		else {
			    		alertBox = document.getElementById("addNewDirectorySuccessAlert");
			    		alertBox.style.display = "block";
			    		alertBox.innerHTML = "Directory indexing successful.";
			    		setTimeout(function(){ alertBox.style.display = "none"; }, 1000);
			    		
			    		for(var newPath in response){
			    			var index = Object.keys(directoryMap).length;
				    		var table=document.getElementById("directoryTable");
				    		var row = table.insertRow(index);
							row.id = response[newPath].path;
							row.className = "table mb-0 d-flex border-0";
							row.setAttribute("oncontextmenu","this.click()");
							
							var cell = row.insertCell(0);
							cell.className = "border-0 text-truncate";

							cell.innerHTML = "<a href=\"#\" id='"+"exp-"+response[newPath].path+"' onclick=\"getAllFilesAndSubDirectories('"+encodeURI(response[newPath].path)+"',10)\"><i class=\"fas fa-caret-right mr-2\"></i></a><a href='#' title='"+response[newPath].path+"' onclick=\"getFilesAndSubDirectories('" + decodeURI(encodeURI(response[newPath].path).replace(/%5C/g,"%5C%5C"))+"','"+response[newPath].name+"','noParent'"+ ")\">"+ "<i class=\"fa fa-folder\" aria-hidden=\"true\"></i>\t" + response[newPath].name+"</a>";
			    			directoryMap[newPath] = response[newPath];
			    			searchDirectoryMap[newPath] = response[newPath];
			    			expFilesAndSubDirectoriesList.push(response[newPath]);
			    			
			    			break;
			    		}
		    		}
		    	}
		    	else if(response == null) {
		    		alertBox = document.getElementById("addNewDirectoryFailureAlert");
		    		alertBox.style.display = "block";
		    		alertBox.innerHTML = "Directory already indexed.";
		    		
		    		setTimeout(function(){ alertBox.style.display = "none"; }, 1000);
		    	}
		    }
		}
		
		
		function clearAddNewDirectoryModal(){
			document.getElementById("pathInput").value = "";
			document.getElementById("addNewDirectorySuccessAlert").style.display = "none";
	    	document.getElementById("addNewDirectoryFailureAlert").style.display = "none";
		}
		
		function getDirectoryList() {
			var request = getXmlHttpRequestObject();
			request.onreadystatechange = getDirectoryListResponse;
			request.open("get", "directories", true);
			request.send();
		}
		
		function getDirectoryListResponse() {
			 if(this.readyState===4 && this.status===200){
				directoryMap = JSON.parse(this.responseText);
				searchDirectoryMap = JSON.parse(this.responseText);
				
				if(directoryMap==null ||  jQuery.isEmptyObject(directoryMap)===true){
					alert("No Directories are Monitored.");
				}
				else{
					var directoryList=[];
					for(var path in directoryMap){
						directoryList.push(directoryMap[path]);
						expFilesAndSubDirectoriesList.push(directoryMap[path]);
					}
			 		renderDirectoryList(directoryList);
			 		document.getElementById("directoryTable").rows[0].click();
				}
			 }
		}
		
		function renderDirectoryList(directoryList) {
			var table=document.getElementById("directoryTable");
			var row,cell;
	
			for(i=0; i<directoryList.length; i++){
				row = table.insertRow(i);
				row.id = directoryList[i].path;
				row.className = "table mb-0 d-flex border-0";
				row.setAttribute("oncontextmenu","this.click()");
				 	
				cell = row.insertCell(0);
				cell.className = "border-0 text-truncate";
				cell.innerHTML = "<a href=\"#\" id='"+"exp-"+directoryList[i].path+"' onclick=\"getAllFilesAndSubDirectories('"+encodeURI(directoryList[i].path)+"',10)\"><i class=\"fas fa-caret-right mr-2\"></i></a><a href='#' title='"+directoryList[i].path+"' onclick=\"getFilesAndSubDirectories('" + decodeURI(encodeURI(directoryList[i].path).replace(/%5C/g,"%5C%5C"))+"','"+directoryList[i].name+"','noParent'"+ ")\">"+ "<i class=\"fa fa-folder\" aria-hidden=\"true\"></i>\t" + directoryList[i].name+"</a>";
			}
		}
		
		function getAllFilesAndSubDirectories(path, currentPadding) {
			path = decodeURI(path);
		
			if(document.getElementById("exp-"+path).firstChild.classList.contains("fa-caret-right")) {
				document.getElementById("exp-"+path).firstChild.classList.remove("fa-caret-right");
				document.getElementById("exp-"+path).firstChild.classList.add("fa-caret-down");
				
				var request = getXmlHttpRequestObject();
				var expFilesAndSubDirectory = [];
				var expFilesAndSubDirectoriesMap = null;
				
				request.onreadystatechange = function() {
			        if (this.readyState == 4 && this.status == 200) {
			        	expFilesAndSubDirectoriesMap = JSON.parse(this.responseText);
			        	
			        	for(var expPath in expFilesAndSubDirectoriesMap) {
			        		if(expFilesAndSubDirectoriesMap[expPath].directory == true) {
			        			expFilesAndSubDirectory.push(expFilesAndSubDirectoriesMap[expPath]);
			        			directoryMap[expPath] = expFilesAndSubDirectoriesMap[expPath];
			        		}
			        	}
			       		renderAllFilesAndSubDirectories(expFilesAndSubDirectory, path, currentPadding);
			       }
			    };
				request.open("post", "filesAndSubDirectory", true);
				request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
				var data = "path="+encodeURI(path);
				request.send(data);	
			}
			else{
				document.getElementById("exp-"+path).firstChild.classList.remove("fa-caret-down");
				document.getElementById("exp-"+path).firstChild.classList.add("fa-caret-right");
				
				hideAllFilesAndSubDirectories(path);
			}
		}
		
		function renderAllFilesAndSubDirectories(filesAndSubDirectories, path, currentPadding) {
			var table=document.getElementById("directoryTable");
			var row = document.getElementById(path);
			var index = row.rowIndex;
			var cell0, cell1, cell2;
			index = index + 1;
			
			for(i=0; i < filesAndSubDirectories.length; i++,index++ ) {
				if(filesAndSubDirectories[i].directory == true) {
					row = table.insertRow(index);
					row.id = filesAndSubDirectories[i].path;
					row.className = path +" "+"table mb-0 d-flex border-0";
					row.setAttribute("oncontextmenu","this.click()");
					
					expFilesAndSubDirectoriesList.splice(index-1, 0, filesAndSubDirectories[i]); 
					
					cell = row.insertCell(0);
					cell.className = "border-0 text-truncate";
					var newPadding = currentPadding+10;
					cell.innerHTML = "<a style='padding-left :"+currentPadding+"px"+"' href=\"#\" id='"+"exp-"+filesAndSubDirectories[i].path+"' onclick=\"getAllFilesAndSubDirectories('"+encodeURI(filesAndSubDirectories[i].path)+"',"+newPadding+")\"><i class=\"fas fa-caret-right mr-2\"></i></a><a href='#' title='"+filesAndSubDirectories[i].path+"' onclick=\"getFilesAndSubDirectories('" + decodeURI(encodeURI(filesAndSubDirectories[i].path).replace(/%5C/g,"%5C%5C"))+"','"+filesAndSubDirectories[i].name+"','noParent'"+ ")\">"+ "<i class=\"fa fa-folder\" aria-hidden=\"true\"></i>\t" + filesAndSubDirectories[i].name+"</a>";		
					}
				}
		}
		
		function hideAllFilesAndSubDirectories(path){
			var table=document.getElementById("directoryTable");
			var classElements = document.getElementsByClassName(path);
			var index = -1;
			var filesAndSubDirectories = [];
			
			for(var i=0; i<classElements.length; i++){
				filesAndSubDirectories.push(classElements[i].getAttribute("id"));
			}
	
			for(var i=0; i<filesAndSubDirectories.length; i++){
				hideAllFilesAndSubDirectories(filesAndSubDirectories[i]);
				index = document.getElementById(filesAndSubDirectories[i]).rowIndex;
				table.deleteRow(index);
				expFilesAndSubDirectoriesList.splice(index - 1,1);
				delete directoryMap[filesAndSubDirectories[i]];
			}
		}
		
		function filterByName(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[a].name.localeCompare(filesAndSubDirectoriesMap[b].name);
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				return filesAndSubDirectoriesMap[a].name.localeCompare(filesAndSubDirectoriesMap[b].name);
			}
			else {
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
        }
		
		function filterByNameReverse(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[b].name.localeCompare(filesAndSubDirectoriesMap[a].name);
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				return filesAndSubDirectoriesMap[b].name.localeCompare(filesAndSubDirectoriesMap[a].name);
			}
			else {
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
        }
		
		function filterBySize(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[a].size - filesAndSubDirectoriesMap[b].size;
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				return filesAndSubDirectoriesMap[a].size - filesAndSubDirectoriesMap[b].size;
			}
			else{
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
		}
		
		function filterBySizeReverse(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[b].size - filesAndSubDirectoriesMap[a].size;
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				return filesAndSubDirectoriesMap[b].size - filesAndSubDirectoriesMap[a].size;
			}
			else{
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
		}
		
		function filterByLastModified(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[a].lastModifiedDate - filesAndSubDirectoriesMap[b].lastModifiedDate;
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				return filesAndSubDirectoriesMap[a].lastModifiedDate - filesAndSubDirectoriesMap[b].lastModifiedDate;
			}
			else{
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
		}
		
		function filterByLastModifiedReverse(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[b].lastModifiedDate - filesAndSubDirectoriesMap[a].lastModifiedDate;
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				return filesAndSubDirectoriesMap[b].lastModifiedDate - filesAndSubDirectoriesMap[a].lastModifiedDate;
			}
			else{
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
		}
		
		function filterByCreationDate(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[a].creationDate - filesAndSubDirectoriesMap[b].creationDate;
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				return filesAndSubDirectoriesMap[a].creationDate - filesAndSubDirectoriesMap[b].creationDate;
			}
			else{
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
		}
		
		function filterByCreationDateReverse(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[b].creationDate - filesAndSubDirectoriesMap[a].creationDate;
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				return filesAndSubDirectoriesMap[b].creationDate - filesAndSubDirectoriesMap[a].creationDate;
			}
			else{
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
		}
		
		function filterByLastOpened(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[a].lastAccessDate - filesAndSubDirectoriesMap[b].lastAccessDate;
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				return filesAndSubDirectoriesMap[a].lastAccessDate - filesAndSubDirectoriesMap[b].lastAccessDate;
			}
			else{
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
		}
		
		function filterByLastOpenedReverse(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[b].lastAccessDate - filesAndSubDirectoriesMap[a].lastAccessDate;
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				return filesAndSubDirectoriesMap[b].lastAccessDate - filesAndSubDirectoriesMap[a].lastAccessDate;
			}
			else{
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
		}
		
		function filterByExtension(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[a].name.localeCompare(filesAndSubDirectoriesMap[b].name);
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				var result = filesAndSubDirectoriesMap[a].extension.localeCompare(filesAndSubDirectoriesMap[b].extension);
				
				if(result == 0)
					return filesAndSubDirectoriesMap[a].name.localeCompare(filesAndSubDirectoriesMap[b].name);
				else
					return result;
			}
			else {
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
        }
		
		function filterByExtensionReverse(a,b) {
			if(filesAndSubDirectoriesMap[a].directory == true && filesAndSubDirectoriesMap[b].directory == true ) {
				return filesAndSubDirectoriesMap[a].name.localeCompare(filesAndSubDirectoriesMap[b].name);
			}
			else if(filesAndSubDirectoriesMap[a].directory != true && filesAndSubDirectoriesMap[b].directory != true) {
				var result = filesAndSubDirectoriesMap[b].extension.localeCompare(filesAndSubDirectoriesMap[a].extension);
				
				if(result == 0)
					return filesAndSubDirectoriesMap[a].name.localeCompare(filesAndSubDirectoriesMap[b].name);
				else
					return result;
			}
			else {
				if(filesAndSubDirectoriesMap[a].directory == true){
					return 1;
				}
				else{
					return -1;
				}
			}
        }

		function sortByName(){
			var filesAndSubDirectories = [];
			var tempMap = {};
			var sortedArray = null;
		
			if (sortedName == true){
				sortedName = false;
				sortedExtension = null;
				sortedLastOpened = null;
				sortedCreationDate = null;
				sortedSize = null;
				sortedLastModified = null;
				sortedArray = Object.keys(filesAndSubDirectoriesMap).sort(filterByName);
			}
			else{
				sortedName = true;
				sortedExtension = null;
				sortedLastOpened = null;
				sortedCreationDate = null;
				sortedSize = null;
				sortedLastModified = null;
				sortedArray  = Object.keys(filesAndSubDirectoriesMap).sort(filterByNameReverse);
			}

			var i=0;
			
			for(i=0; i < sortedArray.length; i++){
				filesAndSubDirectories.push(filesAndSubDirectoriesMap[sortedArray[i]]);
				tempMap[sortedArray[i]] = filesAndSubDirectoriesMap[sortedArray[i]];
			}
			filesAndSubDirectoriesMap = tempMap;
			renderFilesAndSubDirectories(filesAndSubDirectories, currentParent, currentParentName, globalParent);
			currentSort = "name";
			setSortIcon();
		}
		
		function sortBySize(){
			var filesAndSubDirectories = [];
			var tempMap = {};
			var sortedArray = null;

			if (sortedSize == true){
				sortedSize = false;
				sortedExtension = null;
				sortedLastOpened = null;
				sortedCreationDate = null;
				sortedName = null;
				sortedLastModified = null;
				sortedArray = Object.keys(filesAndSubDirectoriesMap).sort(filterBySize);
			}
			else{
				sortedSize = true;
				sortedExtension = null;
				sortedLastOpened = null;
				sortedCreationDate = null;
				sortedName = null;
				sortedLastModified = null;
				sortedArray  = Object.keys(filesAndSubDirectoriesMap).sort(filterBySizeReverse);
			}

			var i=0;
			
			for(i=0; i < sortedArray.length; i++){
				filesAndSubDirectories.push(filesAndSubDirectoriesMap[sortedArray[i]]);
				tempMap[sortedArray[i]] = filesAndSubDirectoriesMap[sortedArray[i]];
			}
			filesAndSubDirectoriesMap = tempMap;
			renderFilesAndSubDirectories(filesAndSubDirectories, currentParent, currentParentName, globalParent);
			currentSort = "size";
			setSortIcon();
		}
		
		function sortByLastModified(){
			var filesAndSubDirectories = [];
			var tempMap = {};
			var sortedArray = null;
			
			if (sortedLastModified == true){
				sortedLastModified = false;
				sortedExtension = null;
				sortedLastOpened = null;
				sortedCreationDate = null;
				sortedName = null;
				sortedSize = null;
				sortedArray = Object.keys(filesAndSubDirectoriesMap).sort(filterByLastModified);
			}
			else{
				sortedLastModified = true;
				sortedExtension = null;
				sortedLastOpened = null;
				sortedCreationDate = null;
				sortedName = null;
				sortedSize = null;
				sortedArray  = Object.keys(filesAndSubDirectoriesMap).sort(filterByLastModifiedReverse);
			}

			var i=0;
			
			for(i=0; i < sortedArray.length; i++){
				filesAndSubDirectories.push(filesAndSubDirectoriesMap[sortedArray[i]]);
				tempMap[sortedArray[i]] = filesAndSubDirectoriesMap[sortedArray[i]];
			}
			filesAndSubDirectoriesMap = tempMap;
			renderFilesAndSubDirectories(filesAndSubDirectories, currentParent, currentParentName, globalParent);
			currentSort = "lastModified";
			setSortIcon();
		}
		
		function sortByCreationDate(){
			var filesAndSubDirectories = [];
			var tempMap = {};
			var sortedArray = null;
			
			if (sortedCreationDate == true){
				sortedCreationDate = false;
				sortedExtension = null;
				sortedLastOpened = null;
				sortedLastModified = null;
				sortedName = null;
				sortedSize = null;
				sortedArray = Object.keys(filesAndSubDirectoriesMap).sort(filterByCreationDate);
			}
			else{
				sortedCreationDate = true;
				sortedExtension = null;
				sortedLastOpened = null;
				sortedLastModified = null;
				sortedName = null;
				sortedSize = null;
				sortedArray  = Object.keys(filesAndSubDirectoriesMap).sort(filterByCreationDateReverse);
			}

			var i=0;
			
			for(i=0; i < sortedArray.length; i++){
				filesAndSubDirectories.push(filesAndSubDirectoriesMap[sortedArray[i]]);
				tempMap[sortedArray[i]] = filesAndSubDirectoriesMap[sortedArray[i]];
			}
			filesAndSubDirectoriesMap = tempMap;
			renderFilesAndSubDirectories(filesAndSubDirectories, currentParent, currentParentName, globalParent);
			currentSort = "creationDate";
			setSortIcon();
		}
		
		function sortByLastOpened(){
			var filesAndSubDirectories = [];
			var tempMap = {};
			var sortedArray = null;
			
			if (sortedLastOpened == true){
				sortedLastOpened = false;
				sortedExtension = null;
				sortedLastModified = null;
				sortedCreationDate = null;
				sortedName = null;
				sortedSize = null;
				sortedArray = Object.keys(filesAndSubDirectoriesMap).sort(filterByLastOpened);
			}
			else{
				sortedLastOpened = true;
				sortedExtension = null;
				sortedLastModified = null;
				sortedCreationDate = null;
				sortedName = null;
				sortedSize = null;
				sortedArray  = Object.keys(filesAndSubDirectoriesMap).sort(filterByLastOpenedReverse);
			}

			var i=0;
			
			for(i=0; i < sortedArray.length; i++){
				filesAndSubDirectories.push(filesAndSubDirectoriesMap[sortedArray[i]]);
				tempMap[sortedArray[i]] = filesAndSubDirectoriesMap[sortedArray[i]];
			}
			filesAndSubDirectoriesMap = tempMap;
			renderFilesAndSubDirectories(filesAndSubDirectories, currentParent, currentParentName, globalParent);
			currentSort = "lastOpened";
			setSortIcon();
		}
		
		function sortByExtension(){
			var filesAndSubDirectories = [];
			var tempMap = {};
			var sortedArray = null;
		
			if (sortedExtension == true){
				sortedExtension = false;
				sortedName = null;
				sortedLastOpened = null;
				sortedCreationDate = null;
				sortedSize = null;
				sortedLastModified = null;
				sortedArray = Object.keys(filesAndSubDirectoriesMap).sort(filterByExtension);
			}
			else{
				sortedExtension = true;
				sortedName = null;
				sortedLastOpened = null;
				sortedCreationDate = null;
				sortedSize = null;
				sortedLastModified = null;
				sortedArray  = Object.keys(filesAndSubDirectoriesMap).sort(filterByExtensionReverse);
			}

			var i=0;
			
			for(i=0; i < sortedArray.length; i++){
				filesAndSubDirectories.push(filesAndSubDirectoriesMap[sortedArray[i]]);
				tempMap[sortedArray[i]] = filesAndSubDirectoriesMap[sortedArray[i]];
			}
			filesAndSubDirectoriesMap = tempMap;
			renderFilesAndSubDirectories(filesAndSubDirectories, currentParent, currentParentName, globalParent);
			currentSort = "extension";
			setSortIcon();
		}

		function getFilesAndSubDirectories(path, name, parent) {
			var request = getXmlHttpRequestObject();
			request.onreadystatechange = function() {
		        if (this.readyState == 4 && this.status == 200) {
			        filesAndSubDirectoriesMap = JSON.parse(request.responseText);
			      
			        currentParentName = name;
			        currentParent = path;
			        globalParent = parent;
			        
			        var filesAndSubDirectories = [];
			        
			        for(var key in filesAndSubDirectoriesMap){
						filesAndSubDirectories.push(filesAndSubDirectoriesMap[key]);
					}
			        
			        if(parent == 'null'){
			        	parent = "noParent";
			        	globalParent = parent;
			        }
			        
			       	renderFilesAndSubDirectories(filesAndSubDirectories, path, name, parent);
		       }
		    };
			request.open("post", "filesAndSubDirectory", true);
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			var data = "path="+path;
			request.send(data);	
		}
		
		function renderFilesAndSubDirectories(filesAndSubDirectories, path, name, parent) {
			var directoryTreeHead = null;
			var isAlreadyExists = null;
			
			if(parent == "noParent"){
				if(path == null && name == null){
					$("#directoryTreeHead").children().remove();
					directoryTreeHead = document.getElementById("directoryTreeHead");
					directoryTreeHead.innerHTML = directoryTreeHead.innerHTML + "<span id=\"treeHead-search\"> > "+filesAndSubDirectories.length+" Search Results </span>";
				}
				else {
					$("#directoryTreeHead").children().remove();
					directoryTreeHead = document.getElementById("directoryTreeHead");
					directoryTreeHead.innerHTML = directoryTreeHead.innerHTML + "<span id=\""+ "treeHead-"+decodeURI(encodeURI(path).replace(/%5C/g,"%5C%5C")) +"\"> > "+"<a href=\"#\" class=\"text-white\" onclick=\"getFilesAndSubDirectories('" + decodeURI(encodeURI(path).replace(/%5C/g,"%5C%5C")) +"','"+name+"','"+decodeURI(encodeURI(parent).replace(/%5C/g,"%5C%5C")) + "')\">"+name+"</a></span>";
				}
			}
			else{
				directoryTreeHead = document.getElementById("treeHead-"+decodeURI(encodeURI(parent).replace(/%5C/g,"%5C%5C")));	
				isAlreadyExists = document.getElementById("treeHead-"+decodeURI(encodeURI(path).replace(/%5C/g,"%5C%5C")));
				if(isAlreadyExists != null ){
					while (isAlreadyExists.firstChild) {
					    isAlreadyExists.removeChild(isAlreadyExists.firstChild);
					}
					isAlreadyExists.remove();
				}
				
				directoryTreeHead.innerHTML = directoryTreeHead.innerHTML + "<span id=\""+ "treeHead-"+decodeURI(encodeURI(path).replace(/%5C/g,"%5C%5C")) +"\"> > "+"<a href=\"#\" class=\"text-white\" onclick=\"getFilesAndSubDirectories('" + decodeURI(encodeURI(path).replace(/%5C/g,"%5C%5C")) +"','"+name+"','"+decodeURI(encodeURI(parent).replace(/%5C/g,"%5C%5C")) + "')\">"+name+"</a></span>";
				
			}
			
			$("#filesAndSubDirectoryTableHead").children().remove();
			$("#filesAndSubDirectoryTableBody").children().remove();
			document.getElementById("tokenSelector").classList.add("d-none");
			document.getElementById("directoryTreeHead").classList.remove("d-none");
			document.getElementById("tokenContainer").classList.add("d-none");
			document.getElementById("directoryContainer").classList.remove("d-none");
			document.getElementById("folderSummaryContainer").classList.add("d-none");
			
			var table=document.getElementById("filesAndSubDirectoryTableHead");
			var row = table.insertRow(0);
			row.className = "table d-flex mb-0";
			row.id = "headingOfTable"
			
			var cell0, cell1, cell2;
			var attr = 0;
			var cell = [];
			
			for(attr = 0 ; attr < attributesToPublish.length ; attr++) {
				if(attributesToPublish.length <= 4 && attr==0){
					cell.push(row.insertCell(attr));
					cell[attr].outerHTML = "<th class=\"col-6 border-0\" id=\"NameHead\">Name<a href=\"#\" onclick=\"sortByName();\"><i id=\"sortNameIcon\" class=\"fas fa-sort px-3 text-dark\"></i></a></th>";
				}
				else{
					cell.push(row.insertCell(attr));
					cell[attr].outerHTML = head[attributesToPublish[attr]];
				}
			}
			
			table=document.getElementById("filesAndSubDirectoryTableBody");
				
			var tbody  = document.getElementById("filesAndSubDirectoryTableBody");
			var config = {
				    height: $('#filesAndSubDirectoryTableBody').outerHeight(true),
				    itemHeight: 49,
				    total: filesAndSubDirectories.length,
				    reverse: false,
				    rowClassName: "vrowFilesAndSubDirectory",
				    afterRender() {
				    	var vrows = document.getElementsByClassName('vrowFilesAndSubDirectory');
					    for (var i = 0; i < vrows.length; i++) {
					    	vrows[i].classList.add("table", "d-flex", "mb-0");
					    	vrows[i].setAttribute("oncontextmenu", "triggerMouseEvent(this, 'mousedown')");
					    	vrows[i].setAttribute("onmousedown", "RowClick(this,false);");
					    	vrows[i].id = vrows[i].cells[0].firstChild.getAttribute("title");
					    }
				      },
				    generate(row) {
				      var el = document.createElement('tr');
				      var searchString = document.getElementById("tableSearchBox").value;
				      
				      if(filesAndSubDirectories[row].directory == true){
				    	  var folderTableContent = {
								"name" : `<td class="col text-truncate"><a href='#' class="true" title='${filesAndSubDirectories[row].path}' onclick="getFilesAndSubDirectories('${decodeURI(encodeURI(filesAndSubDirectories[row].path).replace(/%5C/g,"%5C%5C"))}','${filesAndSubDirectories[row].name}','${decodeURI(encodeURI(path).replace(/%5C/g,"%5C%5C"))}');"><i class="fa fa-folder" aria-hidden="true"></i> ${boldString(filesAndSubDirectories[row].name, searchString)}</a></td>` ,
								"size" : `<td class="col text-truncate">${convertFromBytes(filesAndSubDirectories[row].size)}</td>` ,
								"lastModified" : `<td class="col text-truncate">${time_ago(new Date(filesAndSubDirectories[row].lastModifiedDate))}</td>` , 
								"lastOpened" : `<td class="col text-truncate">${time_ago(new Date(filesAndSubDirectories[row].lastAccessDate))}</td>` ,
								"creationDate" : `<td class="col text-truncate">${time_ago(new Date(filesAndSubDirectories[row].creationDate))}</td>` ,
								"extension"	: `<td class="col text-truncate">NA</td>`
						  };
				    	  
				    	  var attr = 0, rowData=``;
				    	  
				    	  for(attr = 0 ; attr < attributesToPublish.length ; attr++){
				    		  
				    		  if(attributesToPublish.length<=4 && attr==0){
				    			rowData = `<td class="col-6 text-truncate"><a href='#' class="true" title='${filesAndSubDirectories[row].path}' onclick="getFilesAndSubDirectories('${decodeURI(encodeURI(filesAndSubDirectories[row].path).replace(/%5C/g,"%5C%5C"))}','${filesAndSubDirectories[row].name}','${decodeURI(encodeURI(path).replace(/%5C/g,"%5C%5C"))}');"><i class="fa fa-folder" aria-hidden="true"></i> ${boldString(filesAndSubDirectories[row].name, searchString)}</a></td>`;   
				    		  }
				    		  else {
				    		  	rowData = rowData + folderTableContent[attributesToPublish[attr]];
				    		  }
				    	  }
				    	  
				    	  el.innerHTML = rowData;
					      return el;
				      }
				      else{
				    	  var fileTableContent = {
				    			  "name" : `<td class="col text-truncate"><a href='#' onclick="getFileContent('${decodeURI(encodeURI(filesAndSubDirectories[row].path).replace(/%5C/g,"%5C%5C"))}');"  data-toggle="modal" data-target="#fileContentModal" title='${filesAndSubDirectories[row].path}'><i class="fas fa-file"></i> ${boldString(filesAndSubDirectories[row].name, searchString)}</a></td>` ,
							      "size" : `<td class="col text-truncate">${convertFromBytes(filesAndSubDirectories[row].size)}</td>` ,
							      "lastModified" : `<td class="col text-truncate">${time_ago(new Date(filesAndSubDirectories[row].lastModifiedDate))}</td>` ,
							      "lastOpened" : `<td class="col text-truncate">${time_ago(new Date(filesAndSubDirectories[row].lastAccessDate))}</td>` ,
							      "creationDate" : `<td class="col text-truncate">${time_ago(new Date(filesAndSubDirectories[row].creationDate))}</td>` ,
							      "extension" : `<td class="col text-truncate">${filesAndSubDirectories[row].extension}</td>`
				    	  };
				    	  
						  var attr = 0, rowData=``;
				    	  
				    	  for(attr = 0 ; attr < attributesToPublish.length ; attr++){
				    		  
				    		  if(attributesToPublish.length<=4 && attr==0){
				    			rowData = `<td class="col-6 text-truncate"><a href='#' onclick="getFileContent('${decodeURI(encodeURI(filesAndSubDirectories[row].path).replace(/%5C/g,"%5C%5C"))}');"  data-toggle="modal" data-target="#fileContentModal" title='${filesAndSubDirectories[row].path}'><i class="fas fa-file"></i> ${boldString(filesAndSubDirectories[row].name, searchString)}</a></td>`;   
				    		  }
				    		  else {
				    		  	rowData = rowData + fileTableContent[attributesToPublish[attr]];
				    		  }
				    	  }
				    	  
				    	  el.innerHTML = rowData; 
						  return el;
				      }
				    }
					
				  };
			
		    if(filesAndSubDirectoryList == null){
			 	filesAndSubDirectoryList = new HyperList(tbody, config);
		    }
		 
		    else {
		    	filesAndSubDirectoryList.refresh(tbody, config);
		    }
		    
			currentSort = null;
		}
		
		function boldString(str, find){
		    var re = new RegExp(find, 'gi');
		    return str.replace(re, function(str) {return '<b>'+str+'</b>'});
		}
		
		function setSortIcon(){
			if(currentSort == "name") {
				document.getElementById("sortNameIcon").classList.remove("fa-sort");
				if(sortedName == true) {
					document.getElementById("sortNameIcon").classList.add("fa-arrow-down");
				}
				else if(sortedName == false) {
					document.getElementById("sortNameIcon").classList.add("fa-arrow-up");
				} 
			}
			else if(currentSort == "size"){
				document.getElementById("sortSizeIcon").classList.remove("fa-sort");
				if(sortedSize == true) {
					document.getElementById("sortSizeIcon").classList.add("fa-arrow-down");
				}
				else if(sortedSize == false) {
					document.getElementById("sortSizeIcon").classList.add("fa-arrow-up");
				}
			}
			else if(currentSort == "lastModified"){
				document.getElementById("sortLastModifiedIcon").classList.remove("fa-sort");
				if(sortedLastModified == true) {
					document.getElementById("sortLastModifiedIcon").classList.add("fa-arrow-down");
				}
				else if(sortedLastModified == false) {
					document.getElementById("sortLastModifiedIcon").classList.add("fa-arrow-up");
				}
			}
			else if(currentSort == "creationDate"){
				document.getElementById("sortCreationDateIcon").classList.remove("fa-sort");
				if(sortedCreationDate == true) {
					document.getElementById("sortCreationDateIcon").classList.add("fa-arrow-down");
				}
				else if(sortedCreationDate == false) {
					document.getElementById("sortCreationDateIcon").classList.add("fa-arrow-up");
				}
			}
			else if(currentSort == "lastOpened"){
				document.getElementById("sortLastOpenedIcon").classList.remove("fa-sort");
				if(sortedLastOpened == true) {
					document.getElementById("sortLastOpenedIcon").classList.add("fa-arrow-down");
				}
				else if(sortedLastOpened == false) {
					document.getElementById("sortLastOpenedIcon").classList.add("fa-arrow-up");
				}
			}
			else if(currentSort == "extension"){
				document.getElementById("sortExtensionIcon").classList.remove("fa-sort");
				if(sortedExtension == true) {
					document.getElementById("sortExtensionIcon").classList.add("fa-arrow-down");
				}
				else if(sortedExtension == false) {
					document.getElementById("sortExtensionIcon").classList.add("fa-arrow-up");
				}
			}
		}
				
		function getFileContent(filePathContent) {
			var request = getXmlHttpRequestObject();
			request.onreadystatechange = renderFileContent;
			request.open("post", "fileContent", true);
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			var data = "path="+filePathContent;
			request.send(data);	
		}
		
		function renderFileContent(){
			if (this.readyState == 4 && this.status == 200) {
				var content = JSON.parse(this.responseText);
				var renderContent = '';
		
				if(content != null) {
					for(i=0; i<content.length; i++) {
		       			renderContent = renderContent + content[i] + "\n";
					}
					document.getElementById("contentTextArea").innerHTML = renderContent;
					document.getElementById("contentTextArea").rows = content.length + 1;
				}
				else{
					document.getElementById("contentTextArea").innerHTML = "File cannot be displayed in viewer.";
					document.getElementById("contentTextArea").rows = 1;
				}
	       }
		}
		
		function clearFileContentModal() {
			document.getElementById("contentTextArea").innerHTML = '';
			document.getElementById("contentTextArea").rows = 1;
		}
		
		function getTokenStatistics(alphabet){
			if(alphabet == '#'){
				searchAlphabet = "all";
			}
			else{
				searchAlphabet = alphabet;
			}
			
			var request = getXmlHttpRequestObject();
			request.onreadystatechange = setTokenStatistics;
			request.open("get", "tokenStatistics/"+searchAlphabet, true);
			
			var prevSelectedAlphabet = document.getElementsByClassName("currentSelectedAlphabet");
			for (var i = 0; i < prevSelectedAlphabet.length; i++) {
		    	prevSelectedAlphabet[i].classList.remove("currentSelectedAlphabet");   
		    }
			document.getElementsByClassName("alpha")['abcdefghijklmnopqrstuvwxyz#'.indexOf(alphabet)].classList.add("currentSelectedAlphabet");
			
			var prevSelected = document.getElementsByClassName('currentSelected');
		    for (var i = 0; i < prevSelected.length; i++) {
		    	prevSelected[i].classList.add("table");
		    	prevSelected[i].classList.remove("currentSelected");   
		    }
		    document.getElementById("metaTokenDetail").classList.add("d-none");
		    document.getElementById("tokenFileDetails").classList.remove("d-none");
		    
			request.send();	
		}
		
		function setTokenStatistics(){
			 if(this.readyState===4 && this.status===200){
				 $("#tokenStatisticsTableHead").children().remove();
				 $("#tokenStatisticsTableBody").children().remove();
				 tokenStatistics = JSON.parse(this.responseText);
				 renderTokenStatistics(tokenStatistics);
			}
		}
		
		function renderTokenStatistics(tokenStatistics) {
			{
				 var tokenStatisticsTable = document.getElementById("tokenStatisticsTableHead");
				 $("#tokenStatisticsTableHead").children().remove();
				 $("#tokenStatisticsTableBody").children().remove();
				
				 document.getElementById("tokenSelector").classList.remove("d-none");
				 document.getElementById("directoryTreeHead").classList.add("d-none");
				 document.getElementById("tokenContainer").classList.remove("d-none");
				 document.getElementById("directoryContainer").classList.add("d-none");
				 document.getElementById("folderSummaryContainer").classList.add("d-none");
				  
				 var cell0, cell1, cell2, cell3;
				 var thead  = document.getElementById("tokenStatisticsTableHead");
				 var tbody  = document.getElementById("tokenStatisticsTableBody");
				 var keyArray = Object.keys(tokenStatistics);
				 var config = {
					    height: $('#tokenStatisticsTableBody').outerHeight(true),
					    itemHeight: 49,
					    total: keyArray.length,
					    reverse: false,
					    rowClassName: "vrow",
					    afterRender() {
					    	var vrows = document.getElementsByClassName('vrow');
						    for (var i = 0; i < vrows.length; i++) {
						    	vrows[i].classList.add("table","d-flex","mb-0");
						    	vrows[i].id = vrows[i].cells[1].firstChild.getAttribute("title");
						    }
					      },
					    generate(row) {
					      var el = document.createElement('tr');
					      var searchString = document.getElementById("tableSearchBox").value;
					      
					      if(searchString.trim().length > 0) {
							  el.innerHTML = `
						        <td class="col-2 text-truncate">${row+1}</td>
						        <td class="col-8 text-truncate"><a href='#' data-toggle="modal" data-target="#filesOfTokenModal" title="${keyArray[row]}">${boldString(keyArray[row], searchString)}</a></td>
						        <td class="col-2 text-truncate">${tokenStatistics[keyArray[row]]}</td>
						      `;
						      return el;
					      }
					      else{
					    	  el.innerHTML = `
						        <td class="col-2 text-truncate">${row+1}</td>
						        <td class="col-8 text-truncate"><a href='#' data-toggle="modal" data-target="#filesOfTokenModal" title="${keyArray[row]}">${keyArray[row]}</a></td>
						        <td class="col-2 text-truncate">${tokenStatistics[keyArray[row]]}</td>
						      `;
						      return el;
					      }
					    }
						
					  };
				
			    if(list == null){
				 list = new HyperList(tbody, config);
			    }
			 
			    else {
				 list.refresh(tbody, config);
			    }
			 
			 
			    var rowHead = thead.insertRow(0);
			    rowHead.className = "table"+" "+"d-flex"+" "+"mb-0";
			    rowHead.id = "tokenHead";
			 
				cell0 = rowHead.insertCell(0);
				cell0.outerHTML = "<th class=\"col-2 text-truncate border-0\" id=\"tokenNoHead\">#</th>";
				 
				cell1 = rowHead.insertCell(1);
				cell1.outerHTML = "<th class=\"col-8 text-truncate border-0\" id=\"tokenNameHead\">Token</th>";
				 
				cell2 = rowHead.insertCell(2);
				cell2.outerHTML = "<th class=\"col-2 text-truncate border-0 mr-3\" id=\"tokenCountHead\">Count</th>";
		
			 	
		}
	}
		
		
		function setIndexDirectory(){
			var data;
		    var directoryPath = document.getElementById("storagePathInput").value;
	    	data = "path="+directoryPath;
	        var request = getXmlHttpRequestObject();
			request.onreadystatechange = setIndexDirectoryResponse;
			request.open("post", "indexDirectory", true);
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			request.send(data);
		}
		
		function setIndexDirectoryResponse(){
			 if(this.readyState===4 && this.status===200){
			        var response = JSON.parse(this.responseText);
			    	var alertBox = null;
			    	
			    	document.getElementById("addNewStorageDirectorySuccessAlert").style.display = "none";
			    	document.getElementById("addNewStorageDirectoryFailureAlert").style.display = "none";
			    	
			    	if(response.flag == true){
			    		alertBox = document.getElementById("addNewStorageDirectorySuccessAlert");
			    		alertBox.style.display = "block";
			    		alertBox.innerHTML = response.msg;
			    	}
			    	else{
			    		alertBox = document.getElementById("addNewStorageDirectoryFailureAlert");
			    		alertBox.style.display = "block";
			    		alertBox.innerHTML = response.msg;
			    	}
			 }
		}
		
		function clearAddNewIndexStorageModal(){
			document.getElementById("storagePathInput").value = "";
			document.getElementById("addNewStorageDirectorySuccessAlert").style.display = "none";
	    	document.getElementById("addNewStorageDirectoryFailureAlert").style.display = "none";
		}
		
	
		$(document).ready(function() {
			$(function() {
				$("#searchBox").autocomplete({

					source : function(request, response) {
						if(request.term.length < 3){
							return;
						}
						
						$.ajax({
							url : "tokenSuggestions",
							type : "get",
							data : {
								term : request.term
							},
							dataType : "json",
							success : function(data) {
								response(data);
								$('#ui-id-1').css('width', $('#searchInputGroup').width());
								$( "#ui-id-1" ).css( "maxWidth", $('#searchInputGroup').width());
							}
						});
					}                  
				});
			});     
		});
		
		function searchContent(){
			var searchQuery = document.getElementById("searchBox").value;
			var request = getXmlHttpRequestObject();
			request.onreadystatechange = searchResponse;
			request.open("get", "search/"+searchQuery, true);
			request.send();
		}
		
		function searchResponse() {
		    if(this.readyState===4 && this.status===200){
		    	var searchResult = JSON.parse(this.responseText);
				if( searchResult != null && jQuery.isEmptyObject(searchResult) == false){
					filesAndSubDirectoriesMap = searchResult;
			        currentParent = null;
					currentParentName = null;
					globalParent = "noParent";
			        var filesAndSubDirectories = [];
			        
			        for(var key in filesAndSubDirectoriesMap){
						filesAndSubDirectories.push(filesAndSubDirectoriesMap[key]);
					}
			       	renderFilesAndSubDirectories(filesAndSubDirectories, null, null, "noParent");
			    }
				else{
					alert("No Results Found...!!!");
				}
		    }
		}
		
		function time_ago(time) {
   		  switch (typeof time) {
   		    case 'number':
   		      break;
   		    case 'string':
   		      time = +new Date(time);
   		      break;
   		    case 'object':
   		      if (time.constructor === Date) time = time.getTime();
   		      break;
   		    default:
   		      time = +new Date();
   		  }
   		  var time_formats = [
   		    [60, 'seconds', 1], // 60
   		    [120, '1 minute ago', '1 minute from now'], // 60*2
   		    [3600, 'minutes', 60], // 60*60, 60
   		    [7200, '1 hour ago', '1 hour from now'], // 60*60*2
   		    [86400, 'hours', 3600], // 60*60*24, 60*60
   		    [172800, 'Yesterday', 'Tomorrow'], // 60*60*24*2
   		    [604800, 'days', 86400], // 60*60*24*7, 60*60*24
   		  ];
   		  var seconds = (+new Date() - time) / 1000,
   		    token = 'ago',
   		    list_choice = 1;
   		  if (seconds == 0) {
   		    return 'Just now'
   		  }
   		  if (seconds < 0) {
   		    seconds = Math.abs(seconds);
   		    token = 'from now';
   		    list_choice = 2;
   		  }
   		  var i = 0,
   		    format;
   		  while (format = time_formats[i++])
   		    if (seconds < format[0]) {
   		      if (typeof format[2] == 'string')
   		        return format[list_choice];
   		      else
   		        return Math.floor(seconds / format[2]) + ' ' + format[1] + ' ' + token;
   		    }
   		  return new Date(time).toDateString();
   		}
		
		$('#firstCol').on('click', 'table tr', function() {
		    var prevSelected = document.getElementsByClassName('currentSelected');
		    for (var i = 0; i < prevSelected.length; i++) {
		    	prevSelected[i].classList.add("table");
		    	prevSelected[i].classList.remove("currentSelected");   
		    }
		    
		    if(trs != null){
		    	clearAll();	
		    }
		    
		    var prevMidSelected = document.getElementsByClassName('currentMidSelected');
		    for (var i = 0; i < prevMidSelected.length; i++) {
		    	prevMidSelected[i].classList.add("table");
		    	prevMidSelected[i].classList.remove("currentMidSelected");   
		    }
		    
		    this.classList.remove("table");
		    this.classList.add("currentSelected");
		    
		    document.getElementById("metaTokenDetail").classList.remove("d-none");
		    document.getElementById("tokenFileDetails").classList.add("d-none");
		    document.getElementById("tokenFileDetails").innerHTML= "<br><br><div class=\"text-center\">Select token to get details.</div><br><br>";
		    
		    renderDetails(this);
		    
		    this.firstChild.childNodes[1].click();
		});
		
		
		var lastSelectedRow = null;
		var trs;

		document.onselectstart = function() {
		    return false;
		}

		function RowClick(currenttr, lock) {
			
			trs = document.getElementById('filesAndSubDirectoryTableBody').getElementsByTagName('tr');
					
		    if (window.event.ctrlKey) {
		        toggleRow(currenttr);
		    }
		    
		    if (window.event.button === 0) {
		        if (!window.event.ctrlKey && !window.event.shiftKey) {
		        	
		        	if(currenttr.id == "NameHead" || currenttr.id == "SizeHead" || currenttr.id == "LastModifiedHead" || currenttr.id == "headingOfTable"){
						
					}
					else{
						var prevSelected = document.getElementsByClassName('currentSelected');
					    for (var i = 0; i < prevSelected.length; i++) {
					    	prevSelected[i].classList.add("table");
					    	prevSelected[i].classList.remove("currentSelected");   
					    }
						
						var prevMidSelected = document.getElementsByClassName('currentMidSelected');
					    for (var i = 0; i < prevMidSelected.length; i++) {
					    	prevMidSelected[i].classList.add("table");
					    	prevMidSelected[i].classList.remove("currentMidSelected");   
					    }
					    
					    currenttr.classList.add("currentMidSelected");
					    
					    document.getElementById("metaTokenDetail").classList.remove("d-none");
					    document.getElementById("tokenFileDetails").classList.add("d-none");
					    
					    renderDetails(currenttr);
					}
		        	
		            clearAll();
		            toggleRow(currenttr);
		        }
		    
		        if (window.event.shiftKey) {
		            selectRowsBetweenIndexes([lastSelectedRow.rowIndex, currenttr.rowIndex])
		        }
		    }
		}

		function toggleRow(row) {
			if(row.classList.contains("multiSelected")){
				row.classList.remove("multiSelected");
			}
			else{
				row.classList.add("multiSelected");
			}
		    lastSelectedRow = row;
		}

		function selectRowsBetweenIndexes(indexes) {
		    indexes.sort(function(a, b) {
		        return a - b;
		    });

		    for (var i = indexes[0]; i <= indexes[1]; i++) {
		        trs[i-1].classList.add('multiSelected');
		    }
		}

		function clearAll() {
		    for (var i = 0; i < trs.length; i++) {
		        trs[i].classList.remove('multiSelected');
		    }
		}
		
		function renderDetails(selectedElement){
			document.getElementById("tokenCanvas").innerHTML = '';
			$("#fileTokenTableHead").children().remove();
			$("#fileTokenTableBody").children().remove();
			document.getElementById("wordCloudLink").classList.add("d-none");
			
			fileOrDirectory = null;
			fileOrDirectory = directoryMap[selectedElement.id];
			
			if(fileOrDirectory == null){
				fileOrDirectory	= filesAndSubDirectoriesMap[selectedElement.id];
			}
			
			if(fileOrDirectory != null) {
				document.getElementById("nameDetail").innerHTML = fileOrDirectory.name ;
				document.getElementById("modifiedDetail").innerHTML = time_ago(new Date(fileOrDirectory.lastModifiedDate));
				document.getElementById("openedDetail").innerHTML = time_ago(new Date(fileOrDirectory.lastAccessDate));
				document.getElementById("createdDetail").innerHTML = time_ago(new Date(fileOrDirectory.creationDate));
				document.getElementById("typeIconDetail").setAttribute("title", fileOrDirectory.path);
				
				if(fileOrDirectory.directory == true){
					document.getElementById("sizeDetail").innerHTML = convertFromBytes(fileOrDirectory.size) ;
					document.getElementById("typeIconDetail").className = '';
					document.getElementById("typeIconDetail").className = "fa fa-folder fa-2x";
					document.getElementById("typeDetail").innerHTML = "Folder" ;
					document.getElementById("extensionDetail").innerHTML = "NA" ;
					document.getElementById("uploadDetails").classList.remove("d-none");
					document.getElementById("uploadDetails").classList.add("d-flex");
					document.getElementById("downloadDetails").classList.remove("d-flex");
					document.getElementById("downloadDetails").classList.add("d-none");
					document.getElementById("uploadFileDirectoryPath").value = fileOrDirectory.path;
					
					document.getElementById("fileTokenTableHead").innerHTML = "<br><br><center>No token details found.</center><br><br>";	
				}
				else{
					document.getElementById("sizeDetail").innerHTML = convertFromBytes(fileOrDirectory.size);
					document.getElementById("typeIconDetail").className = '';
					document.getElementById("typeIconDetail").className = "fa fa-file fa-2x";
					document.getElementById("typeDetail").innerHTML = "File" ;
					document.getElementById("extensionDetail").innerHTML = fileOrDirectory.extension ;
					document.getElementById("downloadFileLink").setAttribute("href","/directorymonitor/downloadFile?filePath="+encodeURI(fileOrDirectory.path));
					document.getElementById("downloadDetails").classList.remove("d-none");
					document.getElementById("downloadDetails").classList.add("d-flex");
					document.getElementById("uploadDetails").classList.remove("d-flex");
					document.getElementById("uploadDetails").classList.add("d-none");
					
					if(currentParent == null){
						getFileTokens(fileOrDirectory.parent, fileOrDirectory.path);
					}
					else{
						getFileTokens(currentParent, fileOrDirectory.path);
					}
				}
				
				 $('[data-toggle="tooltip"]').tooltip({
					    trigger : 'hover'
				 });
			}
		}
		
		function getFileTokens(parent, filePath) {
			var request = getXmlHttpRequestObject();
			request.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					tokenData = JSON.parse(this.responseText);
					renderTokenDetails(tokenData);
				}
			};
			request.open("post", "tokenDetails", true);
			request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
			var data = "parent=" + parent + "&filePath=" + filePath;
			request.send(data);
		}
			
		function renderTokenDetails(tokenData) {
			$("#fileTokenTableHead").children().remove();
			$("#fileTokenTableBody").children().remove();
			
			var fileTokenTable = document.getElementById("fileTokenTableHead");
			
			if(tokenData == null || jQuery.isEmptyObject(tokenData)){
				fileTokenTable.innerHTML = "<br><br><center>No token details found.</center><br><br>";
				document.getElementById("tokenCanvas").innerHTML = '';
				document.getElementById("wordCloudLink").classList.add("d-none");
				return;
			}
			
			var arrayForChart = [];
			var tokenJSON = {};
			var row = null;
			var cell0 = null;
			var cell1 = null;
			var cell2 = null;
			var itr = 0;
			
			document.getElementById("wordCloudLink").classList.remove("d-none");
			row = fileTokenTable.insertRow(itr);
			row.classList.add("d-flex");
			
			cell0 = row.insertCell(0);
			cell0.outerHTML = "<th class=\"col-3 border-0 text-truncate\"> # </th>";
			
			cell1 = row.insertCell(1);
			cell1.outerHTML = "<th class=\"col-5 border-0 text-truncate\"> Token </th>";
			
			cell2 = row.insertCell(2);
			cell2.outerHTML = "<th class=\"col-4 border-0 text-truncate\"> Count </th>";
			
			itr=0;
			fileTokenTable = document.getElementById("fileTokenTableBody");
			
			for(var tokenKey in tokenData){
				
				if(arrayForChart.length <= 500){
					tokenJSON = {};
					tokenJSON["name"] = tokenKey;
					tokenJSON["y"] = tokenData[tokenKey];
					arrayForChart.push(tokenJSON);
				}
				itr++;
			}	
		
			var keyArray = Object.keys(tokenData);
			var config = {
				    height: $('#fileTokenTableBody').outerHeight(true),
				    itemHeight: 49,
				    total: keyArray.length,
				    reverse: false,
				    rowClassName: "vrowFileTokens",
				    afterRender() {
				    	var vrows = document.getElementsByClassName('vrowFileTokens');
					    for (var i = 0; i < vrows.length; i++) {
					    	vrows[i].classList.add("table","d-flex");
					    }
				      },
				    generate(row) {
				      var el = document.createElement('tr');
					  el.innerHTML = `
				        <td class="col-3">${row+1}</td>
				        <td class="col-5 text-truncate">${keyArray[row]}</td>
				        <td class="col-4">${tokenData[keyArray[row]]}</td>
				      `;
				      return el;
				    }
					
				  };
			
		    if(fileTokenList == null){
			 fileTokenList = new HyperList(fileTokenTable, config);
		    }
		 
		    else {
			 fileTokenList.refresh(fileTokenTable, config);
		    }
			
			var pieColorSet = new Set(Highcharts.getOptions().colors);
			let colorArray = Array.from(pieColorSet);
			
			Highcharts.chart('tokenCanvas', {
			    chart: {
			        plotBackgroundColor: null,
			        plotBorderWidth: null,
			        plotShadow: false,
			        type: 'pie'
			    },
			    title: {
			        text: ''
			    },
			    tooltip: {
			        pointFormat: '<b>{point.percentage:.1f}%</b>'
			    },
			    plotOptions: {
			        pie: {
			            allowPointSelect: false,
			            cursor: 'pointer',
			            colors: colorArray ,
			            dataLabels: {
			            	enabled: true,
			                format: '<b>{point.name}</b>: {point.percentage:.1f} %',
			                filter: {
			                    property: 'percentage',
			                    operator: '>=',
			                    value: 0
			                },
			                style: {
			                    color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
			                },
			                crop: false,
				            overflow: "none",
				            distance: 60,
				            allowOverlap : true
			            },
			            turboThreshold : arrayForChart.length,
			            size: 400,
			        }
			    },
			    series: [{
			        name: '',
			        colorByPoint: true,
			        data: arrayForChart
			    }]
			});
		}
		
		function renderWordCloud() {
			document.getElementById("wordCloudModalBody").innerHTML = '';
			var wordCloudArray = [];
			var wordCloudJSON ={};
			
			for(var wordKey in tokenData){
				if(wordCloudArray.length >= 200){
					break;
				}
				wordCloudJSON = {};
				wordCloudJSON["text"] = wordKey;
				wordCloudJSON["count"] = tokenData[wordKey];
				wordCloudArray.push(wordCloudJSON);
			}
			
			var myConfig = {
				"graphset":[
				{
				"type":"wordcloud",
				"options":{
				  "style":{
				    "tooltip":{
				      visible: true,
				      text: '%text: %hits',
				    }
				  },
				"words": wordCloudArray,
				"max-items" : wordCloudArray.length,
				"min-length": 1,
				aspect: "spiral",
				"minFontSize": 10,
				"maxFontSize":200
				}
				}
				]
				};
			 
			zingchart.render({ 
				id: 'wordCloudModalBody', 
				data: myConfig,
				height: "100%", 
				width: "100%" 
			});
			
			
		}
		
		function getFilesOfToken(token){
			var request = getXmlHttpRequestObject();
			request.onreadystatechange = renderFilesOfToken;
			request.open("get", "tokenDetails/" + token, true);
			request.send();
		}
		
		function renderFilesOfToken() {
			if (this.readyState === 4 && this.status === 200) {
				if (this.responseText == "null") {
					alert("Invalid Token");
				} else {
					$("#filesOfTokenTableHead").children().remove();
					$("#filesOfTokenTableBody").children().remove();
					
					document.getElementById("tokenFileDetails").innerHTML = '';
					
					var table = document.getElementById("filesOfTokenTableHead");
					var tokenStatistics = JSON.parse(this.responseText);
					var i = 0;
					var cell0, cell1, cell2;
					var arrayForChart = [];
					var tokenJSON = {};
					var row = table.insertRow(0);
					row.classList.add("table","d-flex");
					
					cell0 = row.insertCell(0);
					cell0.innerHTML = "#";
					cell0.classList.add("col-1");
					
					cell1 = row.insertCell(1);
					cell1.innerHTML = "File";
					cell1.classList.add("col-9","text-truncate");
					
					cell2 = row.insertCell(2);
					cell2.innerHTML = "Count";
					cell2.classList.add("col-2");
					
					table = document.getElementById("filesOfTokenTableBody");
					
					for ( var key in tokenStatistics) {
						if(arrayForChart.length <= 100) {
							tokenJSON = {};
							tokenJSON["name"] = key;
							tokenJSON["y"] = tokenStatistics[key];
							arrayForChart.push(tokenJSON);
						}
						else{
							break;
						}
						i++;
					}	
					
					 var tbody  = document.getElementById("filesOfTokenTableBody");
					 var keyArray = Object.keys(tokenStatistics);
					 var config = {
						    height: $('#filesOfTokenTableBody').outerHeight(true),
						    itemHeight: 49,
						    total: keyArray.length,
						    reverse: false,
						    rowClassName: "vrowFileOfToken",
						    afterRender() {
						    	var vrows = document.getElementsByClassName('vrowFileOfToken');
							    for (var i = 0; i < vrows.length; i++) {
							    	vrows[i].classList.add("table","d-flex","mb-0");
							    }
						      },
						    generate(row) {
						      var el = document.createElement('tr');
							  el.innerHTML = `
						        <td class="col-1 text-truncate">${row+1}</td>
						        <td class="col-9 text-truncate" title='${keyArray[row]}'>${keyArray[row]}</td>
						        <td class="col-2 text-truncate">${tokenStatistics[keyArray[row]]}</td>
						      `;
						      return el;
						    }
							
						  };
					
				    if(filesOfTokenList == null){
					 	filesOfTokenList = new HyperList(tbody, config);
				    }
				 
				    else {
				    	filesOfTokenList.refresh(tbody, config);
				    }
				 
					var pieColorSet = new Set(Highcharts.getOptions().colors);
					let colorArray = Array.from(pieColorSet);
					
					Highcharts.chart('tokenFileDetails', {
					    chart: {
					        plotBackgroundColor: null,
					        plotBorderWidth: null,
					        plotShadow: false,
					        type: 'pie',
					    },
					    title: {
					        text: ''
					    },
					    tooltip: {
					        pointFormat: '<b>{point.percentage:.1f}%</b>'
					    },
					    plotOptions: {
					        pie: {
					            allowPointSelect: false,
					            cursor: 'pointer',
					            colors: colorArray ,
					            dataLabels: {
					                enabled: false,
					            },
					            turboThreshold : arrayForChart.length
					        }
					    },
					    series: [{
					        name: '',
					        colorByPoint: true,
					        data: arrayForChart
					    }]
					});
				}
			}
		}
		
		$('#tokenContainer').on('click', 'table tr', function() {
			if(this.id == "tokenHead" || this.id == "tokenNoHead" || this.id == "tokenNameHead" || this.id == "tokenCountHead"){
				
			}
			else{
				var prevSelected = document.getElementsByClassName('currentSelected');
			    for (var i = 0; i < prevSelected.length; i++) {
			    	prevSelected[i].classList.add("table");
			    	prevSelected[i].classList.remove("currentSelected");   
			    }
			    
				var prevMidSelected = document.getElementsByClassName('currentMidSelected');
			    for (var i = 0; i < prevMidSelected.length; i++) {
			    	prevMidSelected[i].classList.add("table");
			    	prevMidSelected[i].classList.remove("currentMidSelected");   
			    }
			    
			    this.classList.add("currentMidSelected");
			    
			    document.getElementById("metaTokenDetail").classList.add("d-none");
			    document.getElementById("tokenFileDetails").classList.remove("d-none");
			    
			    getFilesOfToken(this.id);
			}
		});

		
		function convertFromBytes(bytes){
			var size = null;
			if(Math.floor(bytes/1024) == 0){
				return bytes + " Bytes";
			}
			else if(Math.floor(bytes/(1024*1024)) == 0){
				return parseFloat((bytes * 1.0)/1024).toFixed(2) + " KB";
			}
			else if(Math.floor(bytes/(1024*1024*1024)) == 0){
				return parseFloat((bytes * 1.0)/(1024 * 1024)).toFixed(2) + " MB";
			}
			else {
				return parseFloat((bytes * 1.0)/(1024 * 1024 * 1024)).toFixed(2) + " GB";
			}
		}
		
		function hideMenu(){
		    document.getElementById("wordCloudModalBody-menu-item-viewsource").style.display = "none";
		    document.getElementById("wordCloudModalBody-menu-item-viewdatatable").style.display = "none";
		}
		
		const menu = document.querySelector(".menu");
		let menuVisible = false;

		const toggleMenu = command => {
		  menu.style.display = command === "show" ? "block" : "none";
		  menuVisible = !menuVisible;
		};

		const setPosition = ({ top, left }) => {
		  menu.style.left = `${left}px`;
		  menu.style.top = `${top}px`;
		  toggleMenu("show");
		};

		window.addEventListener("click", e => {
		  if(menuVisible)toggleMenu("hide");
		});
		
		
		$('#directoryTable').on('contextmenu', 'tr', function(e) {
		  e.preventDefault();
		  const origin = {
		    left: e.pageX,
		    top: e.pageY
		  };
		  
		  $('.temp').remove();
		  var contextMenu = document.getElementById("contextMenuOptions");
		  contextMenu.innerHTML = contextMenu.innerHTML +
								  `<li class="menu-option temp" onclick="getFolderSummary()">View Summary</li>`+
								  `<li class="menu-option temp" onclick="exploreDirectory();">Explore Directory</li>`+
								  `<li class="menu-option temp" onclick="document.getElementById('fileUploadField').click(); return false;">Upload File</li>`+
								  `<li class="menu-option temp" onclick="downloadFolder(); return false;">Download Folder</li>`;
		  
		  setPosition(origin);
		  return false;
		});
		
		$('#filesAndSubDirectoryTableBody').on('contextmenu', 'tr', function(e) {
		  e.preventDefault();
		  const origin = {
		    left: e.pageX,
		    top: e.pageY
		  };
		  
		var type = null;
		var prevMidSelected = document.getElementsByClassName('currentMidSelected');
		for (var i = 0; i < prevMidSelected.length; i++) {
	    	type = prevMidSelected[i].firstChild.firstChild.firstChild.classList.value;
	    	break;
	   	}
		
		$('.temp').remove();
		
	    var contextMenu = document.getElementById("contextMenuOptions");
	    
	    if(document.getElementsByClassName('multiSelected').length > 1){
	    	contextMenu.innerHTML = contextMenu.innerHTML +
		    						`<li class="menu-option temp" onclick="downloadMultipleFiles()">Download All</li>`;
		    
	    	setPosition(origin);
			return false;
	    }
	    
		if(type == "fas fa-file"){
			contextMenu.innerHTML = contextMenu.innerHTML +
								    `<li class="menu-option temp" onclick="viewFileByMenu();">View File</li>`+
								    `<li class="menu-option temp" onclick="document.getElementById('wordCloudLink').firstChild.click(); return false;">Visualize Tokens</li>`+
								    `<li class="menu-option temp" onclick="document.getElementById('downloadFileLink').click(); return false;">Download File</li>`;
		}
		else if(type == "fa fa-folder"){
			contextMenu.innerHTML = contextMenu.innerHTML +
								    `<li class="menu-option temp" onclick="getFolderSummary()">View Summary</li>`+
								    `<li class="menu-option temp" onclick="exploreDirectory();">Explore Directory</li>`+
								    `<li class="menu-option temp" onclick="document.getElementById('fileUploadField').click(); return false;">Upload File</li>`+
								    `<li class="menu-option temp" onclick="downloadFolder(); return false;">Download Folder</li>`;
		}
		
		setPosition(origin);
		return false;
		});

		function downloadMultipleFiles() {
			var selected = document.getElementsByClassName('multiSelected');
			var json = [];
			
			for(var i=0 ; i < selected.length ; i++) {
				json.push(selected[i].id);
			}
			var data = JSON.stringify(json);
			window.location.href = encodeURI(window.location.href.substring(0, window.location.href.indexOf("/")) + "downloadAll?paths="+data); 
		}
		
		function downloadFolder(){
			var id;
			var prevMidSelected = document.getElementsByClassName('currentMidSelected');
			for (var i = 0; i < prevMidSelected.length; i++) {
		    	id = prevMidSelected[i].id;
		    	break;
		   	}
			
			var prevSelected = document.getElementsByClassName('currentSelected');
		    for (var i = 0; i < prevSelected.length; i++) {
		    	id = prevSelected[i].id;
		    	break;
		    }
		    
			var json = [];
			json.push(id);
			var data = JSON.stringify(json);
			window.location.href = encodeURI(window.location.href.substring(0, window.location.href.indexOf("/")) + "downloadAll?paths="+data); 
		}
		
		function triggerMouseEvent (node, eventType) {
			if(document.getElementsByClassName('multiSelected').length <= 1) {
		    	var clickEvent = document.createEvent ('MouseEvents');
		    	clickEvent.initEvent (eventType, true, true);
		    	node.dispatchEvent (clickEvent);
			}
		}
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
	<script src="hyperlist.js"></script>
</body>
</html>














